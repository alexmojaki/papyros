"use strict";(self.webpackChunkpapyros=self.webpackChunkpapyros||[]).push([[114],{872:(e,t,n)=>{var r;n.d(t,{z:()=>c}),function(e){e.Python="Python",e.JavaScript="JavaScript"}(r||(r={})),r.Python,r.JavaScript,new Map([["python",r.Python],["javascript",r.JavaScript]]),r.Python;var a,o=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)i.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(a)throw a.error}}return i},i=function(e,t,n){if(n||2===arguments.length)for(var r,a=0,o=t.length;a<o;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))};function s(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=e!==a.Debug;r&&(e===a.Error?console.error.apply(console,i([],o(t),!1)):console.log.apply(console,i([],o(t),!1)))}!function(e){e[e.Debug=0]="Debug",e[e.Error=1]="Error",e[e.Important=2]="Important"}(a||(a={}));var c=function(){function e(){this.onEvent=function(){},this.runId=0}return e.prototype.launch=function(e,t,n){var r=this,a=function(e,t){if(e&&t){var n=new TextDecoder;return function(){for(;"timed-out"===Atomics.wait(t,0,0,100););Atomics.store(t,0,0);var r=Atomics.exchange(t,1,0),a=e.slice(0,r);return n.decode(a)}}return function(){var e=new XMLHttpRequest;do{e.open("GET","/__papyros_input",!1),e.send(null)}while(e.status>=400);return e.responseText}}(t,n);return this.onEvent=function(t){if(t.runId=r.runId,e(t),"input"===t.type)return a()},Promise.resolve()},e.prototype.runCode=function(e,t){return n=this,r=void 0,i=function(){var n,r,o;return function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,(function(i){switch(i.label){case 0:this.runId=t,s(a.Debug,"Running code in worker: ",e),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this._runCodeInternal(e)];case 2:return n=i.sent(),s(a.Important,"ran code: "+e+" and received: ",n),[2,this.onEvent({type:"success",data:n,runId:t})];case 3:return r=i.sent(),o="toString"in r?r.toString():JSON.stringify(r),s(a.Error,"Error during execution: ",r,o),[2,this.onEvent({type:"error",data:o,runId:t})];case 4:return[2]}}))},new((o=void 0)||(o=Promise))((function(e,t){function a(e){try{c(i.next(e))}catch(e){t(e)}}function s(e){try{c(i.throw(e))}catch(e){t(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(a,s)}c((i=i.apply(n,r||[])).next())}));var n,r,o,i},e}()},375:(e,t,n)=>{n.d(t,{Jj:()=>u});const r=Symbol("Comlink.proxy"),a=Symbol("Comlink.endpoint"),o=Symbol("Comlink.releaseProxy"),i=Symbol("Comlink.thrown"),s=e=>"object"==typeof e&&null!==e||"function"==typeof e,c=new Map([["proxy",{canHandle:e=>s(e)&&e[r],serialize(e){const{port1:t,port2:n}=new MessageChannel;return u(e,t),[n,[n]]},deserialize:e=>(e.start(),f(e,[],undefined))}],["throw",{canHandle:e=>s(e)&&i in e,serialize({value:e}){let t;return t=e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[t,[]]},deserialize(e){if(e.isError)throw Object.assign(new Error(e.value.message),e.value);throw e.value}}]]);function u(e,t=self){t.addEventListener("message",(function n(a){if(!a||!a.data)return;const{id:o,type:s,path:c}=Object.assign({path:[]},a.data),p=(a.data.argumentList||[]).map(v);let f;try{const t=c.slice(0,-1).reduce(((e,t)=>e[t]),e),n=c.reduce(((e,t)=>e[t]),e);switch(s){case"GET":f=n;break;case"SET":t[c.slice(-1)[0]]=v(a.data.value),f=!0;break;case"APPLY":f=n.apply(t,p);break;case"CONSTRUCT":f=function(e){return Object.assign(e,{[r]:!0})}(new n(...p));break;case"ENDPOINT":{const{port1:t,port2:n}=new MessageChannel;u(e,n),f=function(e,t){return y.set(e,t),e}(t,[t])}break;case"RELEASE":f=void 0;break;default:return}}catch(e){f={value:e,[i]:0}}Promise.resolve(f).catch((e=>({value:e,[i]:0}))).then((e=>{const[r,a]=d(e);t.postMessage(Object.assign(Object.assign({},r),{id:o}),a),"RELEASE"===s&&(t.removeEventListener("message",n),l(t))}))})),t.start&&t.start()}function l(e){(function(e){return"MessagePort"===e.constructor.name})(e)&&e.close()}function p(e){if(e)throw new Error("Proxy has been released and is not useable")}function f(e,t=[],n=function(){}){let r=!1;const i=new Proxy(n,{get(n,a){if(p(r),a===o)return()=>m(e,{type:"RELEASE",path:t.map((e=>e.toString()))}).then((()=>{l(e),r=!0}));if("then"===a){if(0===t.length)return{then:()=>i};const n=m(e,{type:"GET",path:t.map((e=>e.toString()))}).then(v);return n.then.bind(n)}return f(e,[...t,a])},set(n,a,o){p(r);const[i,s]=d(o);return m(e,{type:"SET",path:[...t,a].map((e=>e.toString())),value:i},s).then(v)},apply(n,o,i){p(r);const s=t[t.length-1];if(s===a)return m(e,{type:"ENDPOINT"}).then(v);if("bind"===s)return f(e,t.slice(0,-1));const[c,u]=h(i);return m(e,{type:"APPLY",path:t.map((e=>e.toString())),argumentList:c},u).then(v)},construct(n,a){p(r);const[o,i]=h(a);return m(e,{type:"CONSTRUCT",path:t.map((e=>e.toString())),argumentList:o},i).then(v)}});return i}function h(e){const t=e.map(d);return[t.map((e=>e[0])),(n=t.map((e=>e[1])),Array.prototype.concat.apply([],n))];var n}const y=new WeakMap;function d(e){for(const[t,n]of c)if(n.canHandle(e)){const[r,a]=n.serialize(e);return[{type:"HANDLER",name:t,value:r},a]}return[{type:"RAW",value:e},y.get(e)||[]]}function v(e){switch(e.type){case"HANDLER":return c.get(e.name).deserialize(e.value);case"RAW":return e.value}}function m(e,t,n){return new Promise((r=>{const a=new Array(4).fill(0).map((()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16))).join("-");e.addEventListener("message",(function t(n){n.data&&n.data.id&&n.data.id===a&&(e.removeEventListener("message",t),r(n.data))})),e.start&&e.start(),e.postMessage(Object.assign({id:a},t),n)}))}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTE0LmJ1bmRsZS5qcyIsIm1hcHBpbmdzIjoiZ0dBQUEsSUFBWUEsRSxpQkFBWixTQUFZQSxHQUNSLGtCQUNBLDBCQUZKLENBQVlBLElBQUFBLEVBQW1CLEtBTTNCQSxFQUFvQkMsT0FDcEJELEVBQW9CRSxXQUdILElBQUlDLElBQUksQ0FDekIsQ0FBQyxTQUFVSCxFQUFvQkMsUUFDL0IsQ0FBQyxhQUFjRCxFQUFvQkUsY0NHS0YsRUFBb0JDLE9BYnpELElDRktHLEUsNGRBS0wsU0FBU0MsRUFBV0MsRyxJQUFrQix3REFDekMsSUFBTUMsRUFBd0NELElBQVlGLEVBQVFJLE1BQzlERCxJQUNJRCxJQUFZRixFQUFRSyxNQUNwQkMsUUFBUUMsTUFBSyxNQUFiRCxRQUFPLE9BQVVFLElBQUksSUFFckJGLFFBQVFHLElBQUcsTUFBWEgsUUFBTyxPQUFRRSxJQUFJLE1BWC9CLFNBQVlSLEdBQ1IscUJBQU8scUJBQU8sNkJBRGxCLENBQVlBLElBQUFBLEVBQU8sSyxJQ3FDbkIsYUFJSSxhQUVJVSxLQUFLQyxRQUFVLGFBQ2ZELEtBQUtFLE1BQVEsRUE0Q3JCLE9BbENJLFlBQUFDLE9BQUEsU0FBT0YsRUFDSEcsRUFBNkJDLEdBRGpDLFdBRVVDLEVBcERkLFNBQTBCRixFQUE2QkMsR0FDbkQsR0FBSUQsR0FBa0JDLEVBQWUsQ0FDakMsSUFBTSxFQUFjLElBQUlFLFlBQ3hCLE9BQU8sV0FFSCxLQUNtRCxjQUEzQ0MsUUFBUUMsS0FBS0osRUFBZSxFQUFHLEVBQUcsT0FTMUNHLFFBQVFFLE1BQU1MLEVBQWUsRUFBRyxHQUNoQyxJQUFNTSxFQUFPSCxRQUFRSSxTQUFTUCxFQUFlLEVBQUcsR0FDMUNRLEVBQVFULEVBQWVVLE1BQU0sRUFBR0gsR0FDdEMsT0FBTyxFQUFZSSxPQUFPRixJQUc5QixPQUFPLFdBQ0gsSUFBTUcsRUFBVSxJQUFJQyxlQUNwQixHQUVJRCxFQUFRRSxLQUFLLE1GVEssb0JFU3NCLEdBQ3hDRixFQUFRRyxLQUFLLFlBQ1JILEVBQVFJLFFBQVUsS0FDM0IsT0FBT0osRUFBUUssY0F3QkdDLENBQWlCbEIsRUFBZ0JDLEdBUXZELE9BUEFMLEtBQUtDLFFBQVUsU0FBQ3NCLEdBR1osR0FGQUEsRUFBRXJCLE1BQVEsRUFBS0EsTUFDZkQsRUFBUXNCLEdBQ08sVUFBWEEsRUFBRUMsS0FDRixPQUFPbEIsS0FHUm1CLFFBQVFDLFdBV2IsWUFBQUMsUUFBTixTQUFjQyxFQUFjMUIsRyxtb0NBQ3hCRixLQUFLRSxNQUFRQSxFQUNiWCxFQUFXRCxFQUFRSSxNQUFPLDJCQUE0QmtDLEcsaUJBRXJDLE8sc0JBQUEsR0FBTTVCLEtBQUs2QixpQkFBaUJELEksT0FFekMsT0FGTUUsRUFBTyxTQUNidkMsRUFBV0QsRUFBUXlDLFVBQVcsYUFBZUgsRUFBTyxrQkFBbUJFLEdBQ2hFLENBQVAsRUFBTzlCLEtBQUtDLFFBQVEsQ0FBRXVCLEtBQU0sVUFBV00sS0FBTUEsRUFBTTVCLE1BQU9BLEssT0FJMUQsTyxXQUZNOEIsRUFBYyxhQUFjLEVBQVEsRUFBTUMsV0FBYUMsS0FBS0MsVUFBVSxHQUM1RTVDLEVBQVdELEVBQVFLLE1BQU8sMkJBQTRCLEVBQU9xQyxHQUN0RCxDQUFQLEVBQU9oQyxLQUFLQyxRQUFRLENBQUV1QixLQUFNLFFBQVNNLEtBQU1FLEVBQWE5QixNQUFPQSxLLHNUQUczRSxFQW5EQSxJLGdDQ3pCQSxNQUFNa0MsRUFBY0MsT0FBTyxpQkFDckJDLEVBQWlCRCxPQUFPLG9CQUN4QkUsRUFBZUYsT0FBTyx3QkFDdEJHLEVBQWNILE9BQU8sa0JBQ3JCSSxFQUFZQyxHQUF3QixpQkFBUkEsR0FBNEIsT0FBUkEsR0FBZ0MsbUJBQVJBLEVBZ0R4RUMsRUFBbUIsSUFBSXRELElBQUksQ0FDN0IsQ0FBQyxRQTdDd0IsQ0FDekJ1RCxVQUFZRixHQUFRRCxFQUFTQyxJQUFRQSxFQUFJTixHQUN6Q1MsVUFBVUMsR0FDTixNQUFNLE1BQUVDLEVBQUssTUFBRUMsR0FBVSxJQUFJQyxlQUU3QixPQURBQyxFQUFPSixFQUFLQyxHQUNMLENBQUNDLEVBQU8sQ0FBQ0EsS0FFcEJHLFlBQVlDLElBQ1JBLEVBQUtDLFFBdUhGQyxFQXRIU0YsRUFzSE8sR0FEVEcsY0FoRmQsQ0FBQyxRQS9Cd0IsQ0FDekJYLFVBQVlZLEdBQVVmLEVBQVNlLElBQVVoQixLQUFlZ0IsRUFDeERYLFdBQVUsTUFBRVcsSUFDUixJQUFJQyxFQWNKLE9BWklBLEVBREFELGFBQWlCN0QsTUFDSixDQUNUK0QsU0FBUyxFQUNURixNQUFPLENBQ0hHLFFBQVNILEVBQU1HLFFBQ2ZDLEtBQU1KLEVBQU1JLEtBQ1pDLE1BQU9MLEVBQU1LLFFBS1IsQ0FBRUgsU0FBUyxFQUFPRixNQUFBQSxHQUU1QixDQUFDQyxFQUFZLEtBRXhCTixZQUFZTSxHQUNSLEdBQUlBLEVBQVdDLFFBQ1gsTUFBTUksT0FBT0MsT0FBTyxJQUFJcEUsTUFBTThELEVBQVdELE1BQU1HLFNBQVVGLEVBQVdELE9BRXhFLE1BQU1DLEVBQVdELFdBVXpCLFNBQVNOLEVBQU9KLEVBQUtrQixFQUFLQyxNQUN0QkQsRUFBR0UsaUJBQWlCLFdBQVcsU0FBU0MsRUFBU0MsR0FDN0MsSUFBS0EsSUFBT0EsRUFBR3RDLEtBQ1gsT0FFSixNQUFNLEdBQUV1QyxFQUFFLEtBQUU3QyxFQUFJLEtBQUU4QyxHQUFTUixPQUFPQyxPQUFPLENBQUVPLEtBQU0sSUFBTUYsRUFBR3RDLE1BQ3BEeUMsR0FBZ0JILEVBQUd0QyxLQUFLeUMsY0FBZ0IsSUFBSUMsSUFBSUMsR0FDdEQsSUFBSUMsRUFDSixJQUNJLE1BQU1DLEVBQVNMLEVBQUt4RCxNQUFNLEdBQUksR0FBRzhELFFBQU8sQ0FBQzlCLEVBQUsrQixJQUFTL0IsRUFBSStCLElBQU8vQixHQUM1RGdDLEVBQVdSLEVBQUtNLFFBQU8sQ0FBQzlCLEVBQUsrQixJQUFTL0IsRUFBSStCLElBQU8vQixHQUN2RCxPQUFRdEIsR0FDSixJQUFLLE1BRUdrRCxFQUFjSSxFQUVsQixNQUNKLElBQUssTUFFR0gsRUFBT0wsRUFBS3hELE9BQU8sR0FBRyxJQUFNMkQsRUFBY0wsRUFBR3RDLEtBQUswQixPQUNsRGtCLEdBQWMsRUFFbEIsTUFDSixJQUFLLFFBRUdBLEVBQWNJLEVBQVNDLE1BQU1KLEVBQVFKLEdBRXpDLE1BQ0osSUFBSyxZQUdHRyxFQXlJeEIsU0FBZTVCLEdBQ1gsT0FBT2dCLE9BQU9DLE9BQU9qQixFQUFLLENBQUUsQ0FBQ1YsSUFBYyxJQTFJVDRDLENBREEsSUFBSUYsS0FBWVAsSUFHbEMsTUFDSixJQUFLLFdBQ0QsQ0FDSSxNQUFNLE1BQUV4QixFQUFLLE1BQUVDLEdBQVUsSUFBSUMsZUFDN0JDLEVBQU9KLEVBQUtFLEdBQ1owQixFQThIeEIsU0FBa0I1QixFQUFLbUMsR0FFbkIsT0FEQUMsRUFBY0MsSUFBSXJDLEVBQUttQyxHQUNoQm5DLEVBaEkyQnNDLENBQVNyQyxFQUFPLENBQUNBLElBRW5DLE1BQ0osSUFBSyxVQUVHMkIsT0FBY1csRUFFbEIsTUFDSixRQUNJLFFBR1osTUFBTzdCLEdBQ0hrQixFQUFjLENBQUVsQixNQUFBQSxFQUFPLENBQUNoQixHQUFjLEdBRTFDZixRQUFRQyxRQUFRZ0QsR0FDWFksT0FBTzlCLElBQ0QsQ0FBRUEsTUFBQUEsRUFBTyxDQUFDaEIsR0FBYyxNQUU5QitDLE1BQU1iLElBQ1AsTUFBT2MsRUFBV0MsR0FBaUJDLEVBQVloQixHQUMvQ1YsRUFBRzJCLFlBQVk3QixPQUFPQyxPQUFPRCxPQUFPQyxPQUFPLEdBQUl5QixHQUFZLENBQUVuQixHQUFBQSxJQUFPb0IsR0FDdkQsWUFBVGpFLElBRUF3QyxFQUFHNEIsb0JBQW9CLFVBQVd6QixHQUNsQzBCLEVBQWM3QixVQUl0QkEsRUFBR1gsT0FDSFcsRUFBR1gsUUFNWCxTQUFTd0MsRUFBY0MsSUFIdkIsU0FBdUJBLEdBQ25CLE1BQXFDLGdCQUE5QkEsRUFBU0MsWUFBWW5DLE1BR3hCb0MsQ0FBY0YsSUFDZEEsRUFBU0csUUFLakIsU0FBU0MsRUFBcUJDLEdBQzFCLEdBQUlBLEVBQ0EsTUFBTSxJQUFJeEcsTUFBTSw4Q0FHeEIsU0FBUzJELEVBQVlVLEVBQUlNLEVBQU8sR0FBSWYsRUFBUyxjQUN6QyxJQUFJNkMsR0FBa0IsRUFDdEIsTUFBTXBCLEVBQVEsSUFBSXFCLE1BQU05QyxFQUFRLENBQzVCK0MsSUFBSUMsRUFBUzFCLEdBRVQsR0FEQXFCLEVBQXFCRSxHQUNqQnZCLElBQVN0QyxFQUNULE1BQU8sSUFDSWlFLEVBQXVCeEMsRUFBSSxDQUM5QnhDLEtBQU0sVUFDTjhDLEtBQU1BLEVBQUtFLEtBQUtpQyxHQUFNQSxFQUFFeEUsZUFDekJzRCxNQUFLLEtBQ0pNLEVBQWM3QixHQUNkb0MsR0FBa0IsS0FJOUIsR0FBYSxTQUFUdkIsRUFBaUIsQ0FDakIsR0FBb0IsSUFBaEJQLEVBQUtvQyxPQUNMLE1BQU8sQ0FBRW5CLEtBQU0sSUFBTVAsR0FFekIsTUFBTTJCLEVBQUlILEVBQXVCeEMsRUFBSSxDQUNqQ3hDLEtBQU0sTUFDTjhDLEtBQU1BLEVBQUtFLEtBQUtpQyxHQUFNQSxFQUFFeEUsZUFDekJzRCxLQUFLZCxHQUNSLE9BQU9rQyxFQUFFcEIsS0FBS3FCLEtBQUtELEdBRXZCLE9BQU9yRCxFQUFZVSxFQUFJLElBQUlNLEVBQU1PLEtBRXJDTSxJQUFJb0IsRUFBUzFCLEVBQU1DLEdBQ2ZvQixFQUFxQkUsR0FHckIsTUFBTzVDLEVBQU9pQyxHQUFpQkMsRUFBWVosR0FDM0MsT0FBTzBCLEVBQXVCeEMsRUFBSSxDQUM5QnhDLEtBQU0sTUFDTjhDLEtBQU0sSUFBSUEsRUFBTU8sR0FBTUwsS0FBS2lDLEdBQU1BLEVBQUV4RSxhQUNuQ3VCLE1BQUFBLEdBQ0RpQyxHQUFlRixLQUFLZCxJQUUzQk0sTUFBTXdCLEVBQVNNLEVBQVVDLEdBQ3JCWixFQUFxQkUsR0FDckIsTUFBTVcsRUFBT3pDLEVBQUtBLEVBQUtvQyxPQUFTLEdBQ2hDLEdBQUlLLElBQVN6RSxFQUNULE9BQU9rRSxFQUF1QnhDLEVBQUksQ0FDOUJ4QyxLQUFNLGFBQ1ArRCxLQUFLZCxHQUdaLEdBQWEsU0FBVHNDLEVBQ0EsT0FBT3pELEVBQVlVLEVBQUlNLEVBQUt4RCxNQUFNLEdBQUksSUFFMUMsTUFBT3lELEVBQWNrQixHQUFpQnVCLEVBQWlCRixHQUN2RCxPQUFPTixFQUF1QnhDLEVBQUksQ0FDOUJ4QyxLQUFNLFFBQ044QyxLQUFNQSxFQUFLRSxLQUFLaUMsR0FBTUEsRUFBRXhFLGFBQ3hCc0MsYUFBQUEsR0FDRGtCLEdBQWVGLEtBQUtkLElBRTNCd0MsVUFBVVYsRUFBU08sR0FDZlosRUFBcUJFLEdBQ3JCLE1BQU83QixFQUFja0IsR0FBaUJ1QixFQUFpQkYsR0FDdkQsT0FBT04sRUFBdUJ4QyxFQUFJLENBQzlCeEMsS0FBTSxZQUNOOEMsS0FBTUEsRUFBS0UsS0FBS2lDLEdBQU1BLEVBQUV4RSxhQUN4QnNDLGFBQUFBLEdBQ0RrQixHQUFlRixLQUFLZCxNQUcvQixPQUFPTyxFQUtYLFNBQVNnQyxFQUFpQnpDLEdBQ3RCLE1BQU0yQyxFQUFZM0MsRUFBYUMsSUFBSWtCLEdBQ25DLE1BQU8sQ0FBQ3dCLEVBQVUxQyxLQUFLMkMsR0FBTUEsRUFBRSxNQUxuQkMsRUFLK0JGLEVBQVUxQyxLQUFLMkMsR0FBTUEsRUFBRSxLQUozREUsTUFBTUMsVUFBVUMsT0FBT3hDLE1BQU0sR0FBSXFDLEtBRDVDLElBQWdCQSxFQU9oQixNQUFNbEMsRUFBZ0IsSUFBSXNDLFFBZTFCLFNBQVM5QixFQUFZbEMsR0FDakIsSUFBSyxNQUFPSSxFQUFNNkQsS0FBWTlFLEVBQzFCLEdBQUk4RSxFQUFRN0UsVUFBVVksR0FBUSxDQUMxQixNQUFPa0UsRUFBaUJqQyxHQUFpQmdDLEVBQVE1RSxVQUFVVyxHQUMzRCxNQUFPLENBQ0gsQ0FDSWhDLEtBQU0sVUFDTm9DLEtBQUFBLEVBQ0FKLE1BQU9rRSxHQUVYakMsR0FJWixNQUFPLENBQ0gsQ0FDSWpFLEtBQU0sTUFDTmdDLE1BQUFBLEdBRUowQixFQUFjb0IsSUFBSTlDLElBQVUsSUFHcEMsU0FBU2lCLEVBQWNqQixHQUNuQixPQUFRQSxFQUFNaEMsTUFDVixJQUFLLFVBQ0QsT0FBT21CLEVBQWlCMkQsSUFBSTlDLEVBQU1JLE1BQU1ULFlBQVlLLEVBQU1BLE9BQzlELElBQUssTUFDRCxPQUFPQSxFQUFNQSxPQUd6QixTQUFTZ0QsRUFBdUJ4QyxFQUFJMkQsRUFBSzFDLEdBQ3JDLE9BQU8sSUFBSXhELFNBQVNDLElBQ2hCLE1BQU0yQyxFQWVILElBQUlnRCxNQUFNLEdBQ1pPLEtBQUssR0FDTHBELEtBQUksSUFBTXFELEtBQUtDLE1BQU1ELEtBQUtFLFNBQVdDLE9BQU9DLGtCQUFrQmhHLFNBQVMsTUFDdkVpRyxLQUFLLEtBakJObEUsRUFBR0UsaUJBQWlCLFdBQVcsU0FBU2lFLEVBQUUvRCxHQUNqQ0EsRUFBR3RDLE1BQVNzQyxFQUFHdEMsS0FBS3VDLElBQU1ELEVBQUd0QyxLQUFLdUMsS0FBT0EsSUFHOUNMLEVBQUc0QixvQkFBb0IsVUFBV3VDLEdBQ2xDekcsRUFBUTBDLEVBQUd0QyxVQUVYa0MsRUFBR1gsT0FDSFcsRUFBR1gsUUFFUFcsRUFBRzJCLFlBQVk3QixPQUFPQyxPQUFPLENBQUVNLEdBQUFBLEdBQU1zRCxHQUFNMUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wYXB5cm9zLy4vc3JjL1Byb2dyYW1taW5nTGFuZ3VhZ2UudHMiLCJ3ZWJwYWNrOi8vcGFweXJvcy8uL3NyYy9Db25zdGFudHMudHMiLCJ3ZWJwYWNrOi8vcGFweXJvcy8uL3NyYy91dGlsL0xvZ2dpbmcudHMiLCJ3ZWJwYWNrOi8vcGFweXJvcy8uL3NyYy9CYWNrZW5kLnRzIiwid2VicGFjazovL3BhcHlyb3MvLi9ub2RlX21vZHVsZXMvY29tbGluay9kaXN0L2VzbS9jb21saW5rLm1qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZW51bSBQcm9ncmFtbWluZ0xhbmd1YWdlIHtcbiAgICBQeXRob24gPSBcIlB5dGhvblwiLFxuICAgIEphdmFTY3JpcHQgPSBcIkphdmFTY3JpcHRcIlxufVxuXG5leHBvcnQgY29uc3QgUFJPR1JBTU1JTkdfTEFOR1VBR0VTID0gW1xuICAgIFByb2dyYW1taW5nTGFuZ3VhZ2UuUHl0aG9uLFxuICAgIFByb2dyYW1taW5nTGFuZ3VhZ2UuSmF2YVNjcmlwdFxuXTtcblxuY29uc3QgTEFOR1VBR0VfTUFQID0gbmV3IE1hcChbXG4gICAgW1wicHl0aG9uXCIsIFByb2dyYW1taW5nTGFuZ3VhZ2UuUHl0aG9uXSxcbiAgICBbXCJqYXZhc2NyaXB0XCIsIFByb2dyYW1taW5nTGFuZ3VhZ2UuSmF2YVNjcmlwdF1cbl0pO1xuXG5leHBvcnQgZnVuY3Rpb24gcGxGcm9tU3RyaW5nKGxhbmd1YWdlOiBzdHJpbmcpOiBQcm9ncmFtbWluZ0xhbmd1YWdlIHtcbiAgICBjb25zdCBsYW5nTEMgPSBsYW5ndWFnZS50b0xvd2VyQ2FzZSgpO1xuICAgIGlmIChMQU5HVUFHRV9NQVAuaGFzKGxhbmdMQykpIHtcbiAgICAgICAgcmV0dXJuIExBTkdVQUdFX01BUC5nZXQobGFuZ0xDKSE7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbnN1cHBvcnRlZCBsYW5ndWFnZTogJHtsYW5ndWFnZX1gKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBQcm9ncmFtbWluZ0xhbmd1YWdlIH0gZnJvbSBcIi4vUHJvZ3JhbW1pbmdMYW5ndWFnZVwiO1xuXG5leHBvcnQgY29uc3QgTUFJTl9BUFBfSUQgPSBcInBhcHlyb3NcIjtcblxuZXhwb3J0IGNvbnN0IE9VVFBVVF9UQV9JRCA9IFwiY29kZS1vdXRwdXQtYXJlYVwiO1xuZXhwb3J0IGNvbnN0IElOUFVUX1RBX0lEID0gXCJjb2RlLWlucHV0LWFyZWFcIjtcbmV4cG9ydCBjb25zdCBFRElUT1JfV1JBUFBFUl9JRCA9IFwiY29kZS1hcmVhXCI7XG5cbmV4cG9ydCBjb25zdCBTVEFURV9TUElOTkVSX0lEID0gXCJzdGF0ZS1zcGlubmVyXCI7XG5leHBvcnQgY29uc3QgQVBQTElDQVRJT05fU1RBVEVfVEVYVF9JRCA9IFwiYXBwbGljYXRpb24tc3RhdGUtdGV4dFwiO1xuXG5leHBvcnQgY29uc3QgUlVOX0JUTl9JRCA9IFwicnVuLWNvZGUtYnRuXCI7XG5leHBvcnQgY29uc3QgVEVSTUlOQVRFX0JUTl9JRCA9IFwidGVybWluYXRlLWJ0blwiO1xuXG5leHBvcnQgY29uc3QgUFJPR1JBTU1JTkdfTEFOR1VBR0VfU0VMRUNUX0lEID0gXCJwcm9ncmFtbWluZy1sYW5ndWFnZS1zZWxlY3RcIjtcbmV4cG9ydCBjb25zdCBERUZBVUxUX1BST0dSQU1NSU5HX0xBTkdVQUdFID0gUHJvZ3JhbW1pbmdMYW5ndWFnZS5QeXRob247XG5cbmV4cG9ydCBjb25zdCBMT0NBTEVfU0VMRUNUX0lEID0gXCJsb2NhbGUtc2VsZWN0XCI7XG5leHBvcnQgY29uc3QgREVGQVVMVF9MT0NBTEUgPSBcIm5sXCI7XG5cbmV4cG9ydCBjb25zdCBJTlBVVF9SRUxBVElWRV9VUkwgPSBcIi9fX3BhcHlyb3NfaW5wdXRcIjtcblxuIiwiZXhwb3J0IGVudW0gTG9nVHlwZSB7XG4gICAgRGVidWcsIEVycm9yLCBJbXBvcnRhbnRcbn1cblxuY29uc3QgRU5WSVJPTk1FTlQ6IHN0cmluZyA9IHByb2Nlc3MuZW52Lk5PREVfRU5WIHx8IFwiZGV2ZWxvcG1lbnRcIjtcbmV4cG9ydCBmdW5jdGlvbiBwYXB5cm9zTG9nKGxvZ1R5cGU6IExvZ1R5cGUsIC4uLmFyZ3M6IGFueVtdKTogdm9pZCB7XG4gICAgY29uc3QgZG9Mb2cgPSBFTlZJUk9OTUVOVCAhPT0gXCJwcm9kdWN0aW9uXCIgfHwgbG9nVHlwZSAhPT0gTG9nVHlwZS5EZWJ1ZztcbiAgICBpZiAoZG9Mb2cpIHtcbiAgICAgICAgaWYgKGxvZ1R5cGUgPT09IExvZ1R5cGUuRXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoLi4uYXJncyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyguLi5hcmdzKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImltcG9ydCB7IElOUFVUX1JFTEFUSVZFX1VSTCB9IGZyb20gXCIuL0NvbnN0YW50c1wiO1xuaW1wb3J0IHsgUGFweXJvc0V2ZW50IH0gZnJvbSBcIi4vUGFweXJvc0V2ZW50XCI7XG5pbXBvcnQgeyBMb2dUeXBlLCBwYXB5cm9zTG9nIH0gZnJvbSBcIi4vdXRpbC9Mb2dnaW5nXCI7XG5cbmZ1bmN0aW9uIGdldElucHV0Q2FsbGJhY2soaW5wdXRUZXh0QXJyYXk/OiBVaW50OEFycmF5LCBpbnB1dE1ldGFEYXRhPzogSW50MzJBcnJheSk6ICgpID0+IHN0cmluZyB7XG4gICAgaWYgKGlucHV0VGV4dEFycmF5ICYmIGlucHV0TWV0YURhdGEpIHtcbiAgICAgICAgY29uc3QgdGV4dERlY29kZXIgPSBuZXcgVGV4dERlY29kZXIoKTtcbiAgICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zdGFudC1jb25kaXRpb25cbiAgICAgICAgICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICAgICAgICAgICAgaWYgKEF0b21pY3Mud2FpdChpbnB1dE1ldGFEYXRhLCAwLCAwLCAxMDApID09PSBcInRpbWVkLW91dFwiKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHBhcHlyb3NMb2cubG9nKFwid2FpdGluZyBvbiBpbnB1dFwiKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgKGludGVycnVwdEJ1ZmZlclswXSA9PT0gMikge1xuICAgICAgICAgICAgICAgICAgICAvLyAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgICAgIC8vIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBBdG9taWNzLnN0b3JlKGlucHV0TWV0YURhdGEsIDAsIDApO1xuICAgICAgICAgICAgY29uc3Qgc2l6ZSA9IEF0b21pY3MuZXhjaGFuZ2UoaW5wdXRNZXRhRGF0YSwgMSwgMCk7XG4gICAgICAgICAgICBjb25zdCBieXRlcyA9IGlucHV0VGV4dEFycmF5LnNsaWNlKDAsIHNpemUpO1xuICAgICAgICAgICAgcmV0dXJuIHRleHREZWNvZGVyLmRlY29kZShieXRlcyk7XG4gICAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3QgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICAgICAgICAgIGRvIHtcbiAgICAgICAgICAgICAgICAvLyBgZmFsc2VgIG1ha2VzIHRoZSByZXF1ZXN0IHN5bmNocm9ub3VzXG4gICAgICAgICAgICAgICAgcmVxdWVzdC5vcGVuKFwiR0VUXCIsIElOUFVUX1JFTEFUSVZFX1VSTCwgZmFsc2UpO1xuICAgICAgICAgICAgICAgIHJlcXVlc3Quc2VuZChudWxsKTtcbiAgICAgICAgICAgIH0gd2hpbGUgKHJlcXVlc3Quc3RhdHVzID49IDQwMCk7IC8vIHRvZG8gYmV0dGVyIGVycm9yIGhhbmRsaW5nXG4gICAgICAgICAgICByZXR1cm4gcmVxdWVzdC5yZXNwb25zZVRleHQ7XG4gICAgICAgIH07XG4gICAgfVxufVxuXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgQmFja2VuZCB7XG4gICAgb25FdmVudDogKGU6IFBhcHlyb3NFdmVudCkgPT4gdm9pZDtcbiAgICBydW5JZDogbnVtYmVyO1xuXG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZW1wdHktZnVuY3Rpb25cbiAgICAgICAgdGhpcy5vbkV2ZW50ID0gKCkgPT4geyB9O1xuICAgICAgICB0aGlzLnJ1bklkID0gMDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJbml0aWFsaXplIHRoZSBiYWNrZW5kLCBzZXR0aW5nIHVwIGFueSBnbG9iYWxzIHJlcXVpcmVkXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbihQYXB5cm9zRXZlbnQpOnZvaWR9IG9uRXZlbnQgQ2FsbGJhY2sgZm9yIHdoZW4gZXZlbnRzIG9jY3VyXG4gICAgICogQHBhcmFtIHtVaW50OEFycmF5fSBpbnB1dFRleHRBcnJheSBPcHRpb25hbCBzaGFyZWQgYnVmZmVyIGZvciBpbnB1dFxuICAgICAqIEBwYXJhbSB7SW50MzJBcnJheX0gaW5wdXRNZXRhRGF0YSBPcHRpb25hbCBzaGFyZWQgYnVmZmVyIGZvciBtZXRhZGF0YSBhYm91dCBpbnB1dFxuICAgICAqIEByZXR1cm4ge1Byb21pc2U8dm9pZD59IFByb21pc2Ugb2YgbGF1bmNoaW5nXG4gICAgICovXG4gICAgbGF1bmNoKG9uRXZlbnQ6IChlOiBQYXB5cm9zRXZlbnQpID0+IHZvaWQsXG4gICAgICAgIGlucHV0VGV4dEFycmF5PzogVWludDhBcnJheSwgaW5wdXRNZXRhRGF0YT86IEludDMyQXJyYXkpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgaW5wdXRDYWxsYmFjayA9IGdldElucHV0Q2FsbGJhY2soaW5wdXRUZXh0QXJyYXksIGlucHV0TWV0YURhdGEpO1xuICAgICAgICB0aGlzLm9uRXZlbnQgPSAoZTogUGFweXJvc0V2ZW50KSA9PiB7XG4gICAgICAgICAgICBlLnJ1bklkID0gdGhpcy5ydW5JZDtcbiAgICAgICAgICAgIG9uRXZlbnQoZSk7XG4gICAgICAgICAgICBpZiAoZS50eXBlID09PSBcImlucHV0XCIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaW5wdXRDYWxsYmFjaygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfVxuXG4gICAgYWJzdHJhY3QgX3J1bkNvZGVJbnRlcm5hbChjb2RlOiBzdHJpbmcpOiBQcm9taXNlPGFueT47XG5cbiAgICAvKipcbiAgICAgKiBWYWxpZGF0ZSBhbmQgcnVuIGFyYml0cmFyeSBjb2RlXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGNvZGUgVGhlIGNvZGUgdG8gcnVuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHJ1bklkIFRoZSB1dWlkIGZvciB0aGlzIGV4ZWN1dGlvblxuICAgICAqIEByZXR1cm4ge1Byb21pc2U8dm9pZD59IFByb21pc2Ugb2YgZXhlY3V0aW9uXG4gICAgICovXG4gICAgYXN5bmMgcnVuQ29kZShjb2RlOiBzdHJpbmcsIHJ1bklkOiBudW1iZXIpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgdGhpcy5ydW5JZCA9IHJ1bklkO1xuICAgICAgICBwYXB5cm9zTG9nKExvZ1R5cGUuRGVidWcsIFwiUnVubmluZyBjb2RlIGluIHdvcmtlcjogXCIsIGNvZGUpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHRoaXMuX3J1bkNvZGVJbnRlcm5hbChjb2RlKTtcbiAgICAgICAgICAgIHBhcHlyb3NMb2coTG9nVHlwZS5JbXBvcnRhbnQsIFwicmFuIGNvZGU6IFwiICsgY29kZSArIFwiIGFuZCByZWNlaXZlZDogXCIsIGRhdGEpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMub25FdmVudCh7IHR5cGU6IFwic3VjY2Vzc1wiLCBkYXRhOiBkYXRhLCBydW5JZDogcnVuSWQgfSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICAgICAgICAgIGNvbnN0IGVycm9yU3RyaW5nID0gXCJ0b1N0cmluZ1wiIGluIGVycm9yID8gZXJyb3IudG9TdHJpbmcoKSA6IEpTT04uc3RyaW5naWZ5KGVycm9yKTtcbiAgICAgICAgICAgIHBhcHlyb3NMb2coTG9nVHlwZS5FcnJvciwgXCJFcnJvciBkdXJpbmcgZXhlY3V0aW9uOiBcIiwgZXJyb3IsIGVycm9yU3RyaW5nKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm9uRXZlbnQoeyB0eXBlOiBcImVycm9yXCIsIGRhdGE6IGVycm9yU3RyaW5nLCBydW5JZDogcnVuSWQgfSk7XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCIvKipcclxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIEluYy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5jb25zdCBwcm94eU1hcmtlciA9IFN5bWJvbChcIkNvbWxpbmsucHJveHlcIik7XHJcbmNvbnN0IGNyZWF0ZUVuZHBvaW50ID0gU3ltYm9sKFwiQ29tbGluay5lbmRwb2ludFwiKTtcclxuY29uc3QgcmVsZWFzZVByb3h5ID0gU3ltYm9sKFwiQ29tbGluay5yZWxlYXNlUHJveHlcIik7XHJcbmNvbnN0IHRocm93TWFya2VyID0gU3ltYm9sKFwiQ29tbGluay50aHJvd25cIik7XHJcbmNvbnN0IGlzT2JqZWN0ID0gKHZhbCkgPT4gKHR5cGVvZiB2YWwgPT09IFwib2JqZWN0XCIgJiYgdmFsICE9PSBudWxsKSB8fCB0eXBlb2YgdmFsID09PSBcImZ1bmN0aW9uXCI7XHJcbi8qKlxyXG4gKiBJbnRlcm5hbCB0cmFuc2ZlciBoYW5kbGUgdG8gaGFuZGxlIG9iamVjdHMgbWFya2VkIHRvIHByb3h5LlxyXG4gKi9cclxuY29uc3QgcHJveHlUcmFuc2ZlckhhbmRsZXIgPSB7XHJcbiAgICBjYW5IYW5kbGU6ICh2YWwpID0+IGlzT2JqZWN0KHZhbCkgJiYgdmFsW3Byb3h5TWFya2VyXSxcclxuICAgIHNlcmlhbGl6ZShvYmopIHtcclxuICAgICAgICBjb25zdCB7IHBvcnQxLCBwb3J0MiB9ID0gbmV3IE1lc3NhZ2VDaGFubmVsKCk7XHJcbiAgICAgICAgZXhwb3NlKG9iaiwgcG9ydDEpO1xyXG4gICAgICAgIHJldHVybiBbcG9ydDIsIFtwb3J0Ml1dO1xyXG4gICAgfSxcclxuICAgIGRlc2VyaWFsaXplKHBvcnQpIHtcclxuICAgICAgICBwb3J0LnN0YXJ0KCk7XHJcbiAgICAgICAgcmV0dXJuIHdyYXAocG9ydCk7XHJcbiAgICB9LFxyXG59O1xyXG4vKipcclxuICogSW50ZXJuYWwgdHJhbnNmZXIgaGFuZGxlciB0byBoYW5kbGUgdGhyb3duIGV4Y2VwdGlvbnMuXHJcbiAqL1xyXG5jb25zdCB0aHJvd1RyYW5zZmVySGFuZGxlciA9IHtcclxuICAgIGNhbkhhbmRsZTogKHZhbHVlKSA9PiBpc09iamVjdCh2YWx1ZSkgJiYgdGhyb3dNYXJrZXIgaW4gdmFsdWUsXHJcbiAgICBzZXJpYWxpemUoeyB2YWx1ZSB9KSB7XHJcbiAgICAgICAgbGV0IHNlcmlhbGl6ZWQ7XHJcbiAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgRXJyb3IpIHtcclxuICAgICAgICAgICAgc2VyaWFsaXplZCA9IHtcclxuICAgICAgICAgICAgICAgIGlzRXJyb3I6IHRydWUsXHJcbiAgICAgICAgICAgICAgICB2YWx1ZToge1xyXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IHZhbHVlLm1lc3NhZ2UsXHJcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogdmFsdWUubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICBzdGFjazogdmFsdWUuc3RhY2ssXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgc2VyaWFsaXplZCA9IHsgaXNFcnJvcjogZmFsc2UsIHZhbHVlIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBbc2VyaWFsaXplZCwgW11dO1xyXG4gICAgfSxcclxuICAgIGRlc2VyaWFsaXplKHNlcmlhbGl6ZWQpIHtcclxuICAgICAgICBpZiAoc2VyaWFsaXplZC5pc0Vycm9yKSB7XHJcbiAgICAgICAgICAgIHRocm93IE9iamVjdC5hc3NpZ24obmV3IEVycm9yKHNlcmlhbGl6ZWQudmFsdWUubWVzc2FnZSksIHNlcmlhbGl6ZWQudmFsdWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aHJvdyBzZXJpYWxpemVkLnZhbHVlO1xyXG4gICAgfSxcclxufTtcclxuLyoqXHJcbiAqIEFsbG93cyBjdXN0b21pemluZyB0aGUgc2VyaWFsaXphdGlvbiBvZiBjZXJ0YWluIHZhbHVlcy5cclxuICovXHJcbmNvbnN0IHRyYW5zZmVySGFuZGxlcnMgPSBuZXcgTWFwKFtcclxuICAgIFtcInByb3h5XCIsIHByb3h5VHJhbnNmZXJIYW5kbGVyXSxcclxuICAgIFtcInRocm93XCIsIHRocm93VHJhbnNmZXJIYW5kbGVyXSxcclxuXSk7XHJcbmZ1bmN0aW9uIGV4cG9zZShvYmosIGVwID0gc2VsZikge1xyXG4gICAgZXAuYWRkRXZlbnRMaXN0ZW5lcihcIm1lc3NhZ2VcIiwgZnVuY3Rpb24gY2FsbGJhY2soZXYpIHtcclxuICAgICAgICBpZiAoIWV2IHx8ICFldi5kYXRhKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgeyBpZCwgdHlwZSwgcGF0aCB9ID0gT2JqZWN0LmFzc2lnbih7IHBhdGg6IFtdIH0sIGV2LmRhdGEpO1xyXG4gICAgICAgIGNvbnN0IGFyZ3VtZW50TGlzdCA9IChldi5kYXRhLmFyZ3VtZW50TGlzdCB8fCBbXSkubWFwKGZyb21XaXJlVmFsdWUpO1xyXG4gICAgICAgIGxldCByZXR1cm5WYWx1ZTtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb25zdCBwYXJlbnQgPSBwYXRoLnNsaWNlKDAsIC0xKS5yZWR1Y2UoKG9iaiwgcHJvcCkgPT4gb2JqW3Byb3BdLCBvYmopO1xyXG4gICAgICAgICAgICBjb25zdCByYXdWYWx1ZSA9IHBhdGgucmVkdWNlKChvYmosIHByb3ApID0+IG9ialtwcm9wXSwgb2JqKTtcclxuICAgICAgICAgICAgc3dpdGNoICh0eXBlKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwiR0VUXCIgLyogR0VUICovOlxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuVmFsdWUgPSByYXdWYWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwiU0VUXCIgLyogU0VUICovOlxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50W3BhdGguc2xpY2UoLTEpWzBdXSA9IGZyb21XaXJlVmFsdWUoZXYuZGF0YS52YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblZhbHVlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwiQVBQTFlcIiAvKiBBUFBMWSAqLzpcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblZhbHVlID0gcmF3VmFsdWUuYXBwbHkocGFyZW50LCBhcmd1bWVudExpc3QpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgXCJDT05TVFJVQ1RcIiAvKiBDT05TVFJVQ1QgKi86XHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IG5ldyByYXdWYWx1ZSguLi5hcmd1bWVudExpc3QpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5WYWx1ZSA9IHByb3h5KHZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwiRU5EUE9JTlRcIiAvKiBFTkRQT0lOVCAqLzpcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHsgcG9ydDEsIHBvcnQyIH0gPSBuZXcgTWVzc2FnZUNoYW5uZWwoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXhwb3NlKG9iaiwgcG9ydDIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5WYWx1ZSA9IHRyYW5zZmVyKHBvcnQxLCBbcG9ydDFdKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwiUkVMRUFTRVwiIC8qIFJFTEVBU0UgKi86XHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5WYWx1ZSA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAodmFsdWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuVmFsdWUgPSB7IHZhbHVlLCBbdGhyb3dNYXJrZXJdOiAwIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFByb21pc2UucmVzb2x2ZShyZXR1cm5WYWx1ZSlcclxuICAgICAgICAgICAgLmNhdGNoKCh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4geyB2YWx1ZSwgW3Rocm93TWFya2VyXTogMCB9O1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC50aGVuKChyZXR1cm5WYWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBbd2lyZVZhbHVlLCB0cmFuc2ZlcmFibGVzXSA9IHRvV2lyZVZhbHVlKHJldHVyblZhbHVlKTtcclxuICAgICAgICAgICAgZXAucG9zdE1lc3NhZ2UoT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCB3aXJlVmFsdWUpLCB7IGlkIH0pLCB0cmFuc2ZlcmFibGVzKTtcclxuICAgICAgICAgICAgaWYgKHR5cGUgPT09IFwiUkVMRUFTRVwiIC8qIFJFTEVBU0UgKi8pIHtcclxuICAgICAgICAgICAgICAgIC8vIGRldGFjaCBhbmQgZGVhY3RpdmUgYWZ0ZXIgc2VuZGluZyByZWxlYXNlIHJlc3BvbnNlIGFib3ZlLlxyXG4gICAgICAgICAgICAgICAgZXAucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1lc3NhZ2VcIiwgY2FsbGJhY2spO1xyXG4gICAgICAgICAgICAgICAgY2xvc2VFbmRQb2ludChlcCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG4gICAgaWYgKGVwLnN0YXJ0KSB7XHJcbiAgICAgICAgZXAuc3RhcnQoKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBpc01lc3NhZ2VQb3J0KGVuZHBvaW50KSB7XHJcbiAgICByZXR1cm4gZW5kcG9pbnQuY29uc3RydWN0b3IubmFtZSA9PT0gXCJNZXNzYWdlUG9ydFwiO1xyXG59XHJcbmZ1bmN0aW9uIGNsb3NlRW5kUG9pbnQoZW5kcG9pbnQpIHtcclxuICAgIGlmIChpc01lc3NhZ2VQb3J0KGVuZHBvaW50KSlcclxuICAgICAgICBlbmRwb2ludC5jbG9zZSgpO1xyXG59XHJcbmZ1bmN0aW9uIHdyYXAoZXAsIHRhcmdldCkge1xyXG4gICAgcmV0dXJuIGNyZWF0ZVByb3h5KGVwLCBbXSwgdGFyZ2V0KTtcclxufVxyXG5mdW5jdGlvbiB0aHJvd0lmUHJveHlSZWxlYXNlZChpc1JlbGVhc2VkKSB7XHJcbiAgICBpZiAoaXNSZWxlYXNlZCkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIlByb3h5IGhhcyBiZWVuIHJlbGVhc2VkIGFuZCBpcyBub3QgdXNlYWJsZVwiKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBjcmVhdGVQcm94eShlcCwgcGF0aCA9IFtdLCB0YXJnZXQgPSBmdW5jdGlvbiAoKSB7IH0pIHtcclxuICAgIGxldCBpc1Byb3h5UmVsZWFzZWQgPSBmYWxzZTtcclxuICAgIGNvbnN0IHByb3h5ID0gbmV3IFByb3h5KHRhcmdldCwge1xyXG4gICAgICAgIGdldChfdGFyZ2V0LCBwcm9wKSB7XHJcbiAgICAgICAgICAgIHRocm93SWZQcm94eVJlbGVhc2VkKGlzUHJveHlSZWxlYXNlZCk7XHJcbiAgICAgICAgICAgIGlmIChwcm9wID09PSByZWxlYXNlUHJveHkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcXVlc3RSZXNwb25zZU1lc3NhZ2UoZXAsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJSRUxFQVNFXCIgLyogUkVMRUFTRSAqLyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF0aDogcGF0aC5tYXAoKHApID0+IHAudG9TdHJpbmcoKSksXHJcbiAgICAgICAgICAgICAgICAgICAgfSkudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsb3NlRW5kUG9pbnQoZXApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpc1Byb3h5UmVsZWFzZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAocHJvcCA9PT0gXCJ0aGVuXCIpIHtcclxuICAgICAgICAgICAgICAgIGlmIChwYXRoLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7IHRoZW46ICgpID0+IHByb3h5IH07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCByID0gcmVxdWVzdFJlc3BvbnNlTWVzc2FnZShlcCwge1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiR0VUXCIgLyogR0VUICovLFxyXG4gICAgICAgICAgICAgICAgICAgIHBhdGg6IHBhdGgubWFwKChwKSA9PiBwLnRvU3RyaW5nKCkpLFxyXG4gICAgICAgICAgICAgICAgfSkudGhlbihmcm9tV2lyZVZhbHVlKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiByLnRoZW4uYmluZChyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gY3JlYXRlUHJveHkoZXAsIFsuLi5wYXRoLCBwcm9wXSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBzZXQoX3RhcmdldCwgcHJvcCwgcmF3VmFsdWUpIHtcclxuICAgICAgICAgICAgdGhyb3dJZlByb3h5UmVsZWFzZWQoaXNQcm94eVJlbGVhc2VkKTtcclxuICAgICAgICAgICAgLy8gRklYTUU6IEVTNiBQcm94eSBIYW5kbGVyIGBzZXRgIG1ldGhvZHMgYXJlIHN1cHBvc2VkIHRvIHJldHVybiBhXHJcbiAgICAgICAgICAgIC8vIGJvb2xlYW4uIFRvIHNob3cgZ29vZCB3aWxsLCB3ZSByZXR1cm4gdHJ1ZSBhc3luY2hyb25vdXNseSDCr1xcXyjjg4QpXy/Cr1xyXG4gICAgICAgICAgICBjb25zdCBbdmFsdWUsIHRyYW5zZmVyYWJsZXNdID0gdG9XaXJlVmFsdWUocmF3VmFsdWUpO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVxdWVzdFJlc3BvbnNlTWVzc2FnZShlcCwge1xyXG4gICAgICAgICAgICAgICAgdHlwZTogXCJTRVRcIiAvKiBTRVQgKi8sXHJcbiAgICAgICAgICAgICAgICBwYXRoOiBbLi4ucGF0aCwgcHJvcF0ubWFwKChwKSA9PiBwLnRvU3RyaW5nKCkpLFxyXG4gICAgICAgICAgICAgICAgdmFsdWUsXHJcbiAgICAgICAgICAgIH0sIHRyYW5zZmVyYWJsZXMpLnRoZW4oZnJvbVdpcmVWYWx1ZSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBhcHBseShfdGFyZ2V0LCBfdGhpc0FyZywgcmF3QXJndW1lbnRMaXN0KSB7XHJcbiAgICAgICAgICAgIHRocm93SWZQcm94eVJlbGVhc2VkKGlzUHJveHlSZWxlYXNlZCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGxhc3QgPSBwYXRoW3BhdGgubGVuZ3RoIC0gMV07XHJcbiAgICAgICAgICAgIGlmIChsYXN0ID09PSBjcmVhdGVFbmRwb2ludCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcXVlc3RSZXNwb25zZU1lc3NhZ2UoZXAsIHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIkVORFBPSU5UXCIgLyogRU5EUE9JTlQgKi8sXHJcbiAgICAgICAgICAgICAgICB9KS50aGVuKGZyb21XaXJlVmFsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIFdlIGp1c3QgcHJldGVuZCB0aGF0IGBiaW5kKClgIGRpZG7igJl0IGhhcHBlbi5cclxuICAgICAgICAgICAgaWYgKGxhc3QgPT09IFwiYmluZFwiKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gY3JlYXRlUHJveHkoZXAsIHBhdGguc2xpY2UoMCwgLTEpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCBbYXJndW1lbnRMaXN0LCB0cmFuc2ZlcmFibGVzXSA9IHByb2Nlc3NBcmd1bWVudHMocmF3QXJndW1lbnRMaXN0KTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcXVlc3RSZXNwb25zZU1lc3NhZ2UoZXAsIHtcclxuICAgICAgICAgICAgICAgIHR5cGU6IFwiQVBQTFlcIiAvKiBBUFBMWSAqLyxcclxuICAgICAgICAgICAgICAgIHBhdGg6IHBhdGgubWFwKChwKSA9PiBwLnRvU3RyaW5nKCkpLFxyXG4gICAgICAgICAgICAgICAgYXJndW1lbnRMaXN0LFxyXG4gICAgICAgICAgICB9LCB0cmFuc2ZlcmFibGVzKS50aGVuKGZyb21XaXJlVmFsdWUpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgY29uc3RydWN0KF90YXJnZXQsIHJhd0FyZ3VtZW50TGlzdCkge1xyXG4gICAgICAgICAgICB0aHJvd0lmUHJveHlSZWxlYXNlZChpc1Byb3h5UmVsZWFzZWQpO1xyXG4gICAgICAgICAgICBjb25zdCBbYXJndW1lbnRMaXN0LCB0cmFuc2ZlcmFibGVzXSA9IHByb2Nlc3NBcmd1bWVudHMocmF3QXJndW1lbnRMaXN0KTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcXVlc3RSZXNwb25zZU1lc3NhZ2UoZXAsIHtcclxuICAgICAgICAgICAgICAgIHR5cGU6IFwiQ09OU1RSVUNUXCIgLyogQ09OU1RSVUNUICovLFxyXG4gICAgICAgICAgICAgICAgcGF0aDogcGF0aC5tYXAoKHApID0+IHAudG9TdHJpbmcoKSksXHJcbiAgICAgICAgICAgICAgICBhcmd1bWVudExpc3QsXHJcbiAgICAgICAgICAgIH0sIHRyYW5zZmVyYWJsZXMpLnRoZW4oZnJvbVdpcmVWYWx1ZSk7XHJcbiAgICAgICAgfSxcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHByb3h5O1xyXG59XHJcbmZ1bmN0aW9uIG15RmxhdChhcnIpIHtcclxuICAgIHJldHVybiBBcnJheS5wcm90b3R5cGUuY29uY2F0LmFwcGx5KFtdLCBhcnIpO1xyXG59XHJcbmZ1bmN0aW9uIHByb2Nlc3NBcmd1bWVudHMoYXJndW1lbnRMaXN0KSB7XHJcbiAgICBjb25zdCBwcm9jZXNzZWQgPSBhcmd1bWVudExpc3QubWFwKHRvV2lyZVZhbHVlKTtcclxuICAgIHJldHVybiBbcHJvY2Vzc2VkLm1hcCgodikgPT4gdlswXSksIG15RmxhdChwcm9jZXNzZWQubWFwKCh2KSA9PiB2WzFdKSldO1xyXG59XHJcbmNvbnN0IHRyYW5zZmVyQ2FjaGUgPSBuZXcgV2Vha01hcCgpO1xyXG5mdW5jdGlvbiB0cmFuc2ZlcihvYmosIHRyYW5zZmVycykge1xyXG4gICAgdHJhbnNmZXJDYWNoZS5zZXQob2JqLCB0cmFuc2ZlcnMpO1xyXG4gICAgcmV0dXJuIG9iajtcclxufVxyXG5mdW5jdGlvbiBwcm94eShvYmopIHtcclxuICAgIHJldHVybiBPYmplY3QuYXNzaWduKG9iaiwgeyBbcHJveHlNYXJrZXJdOiB0cnVlIH0pO1xyXG59XHJcbmZ1bmN0aW9uIHdpbmRvd0VuZHBvaW50KHcsIGNvbnRleHQgPSBzZWxmLCB0YXJnZXRPcmlnaW4gPSBcIipcIikge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBwb3N0TWVzc2FnZTogKG1zZywgdHJhbnNmZXJhYmxlcykgPT4gdy5wb3N0TWVzc2FnZShtc2csIHRhcmdldE9yaWdpbiwgdHJhbnNmZXJhYmxlcyksXHJcbiAgICAgICAgYWRkRXZlbnRMaXN0ZW5lcjogY29udGV4dC5hZGRFdmVudExpc3RlbmVyLmJpbmQoY29udGV4dCksXHJcbiAgICAgICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcjogY29udGV4dC5yZW1vdmVFdmVudExpc3RlbmVyLmJpbmQoY29udGV4dCksXHJcbiAgICB9O1xyXG59XHJcbmZ1bmN0aW9uIHRvV2lyZVZhbHVlKHZhbHVlKSB7XHJcbiAgICBmb3IgKGNvbnN0IFtuYW1lLCBoYW5kbGVyXSBvZiB0cmFuc2ZlckhhbmRsZXJzKSB7XHJcbiAgICAgICAgaWYgKGhhbmRsZXIuY2FuSGFuZGxlKHZhbHVlKSkge1xyXG4gICAgICAgICAgICBjb25zdCBbc2VyaWFsaXplZFZhbHVlLCB0cmFuc2ZlcmFibGVzXSA9IGhhbmRsZXIuc2VyaWFsaXplKHZhbHVlKTtcclxuICAgICAgICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIkhBTkRMRVJcIiAvKiBIQU5ETEVSICovLFxyXG4gICAgICAgICAgICAgICAgICAgIG5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHNlcmlhbGl6ZWRWYWx1ZSxcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB0cmFuc2ZlcmFibGVzLFxyXG4gICAgICAgICAgICBdO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBbXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB0eXBlOiBcIlJBV1wiIC8qIFJBVyAqLyxcclxuICAgICAgICAgICAgdmFsdWUsXHJcbiAgICAgICAgfSxcclxuICAgICAgICB0cmFuc2ZlckNhY2hlLmdldCh2YWx1ZSkgfHwgW10sXHJcbiAgICBdO1xyXG59XHJcbmZ1bmN0aW9uIGZyb21XaXJlVmFsdWUodmFsdWUpIHtcclxuICAgIHN3aXRjaCAodmFsdWUudHlwZSkge1xyXG4gICAgICAgIGNhc2UgXCJIQU5ETEVSXCIgLyogSEFORExFUiAqLzpcclxuICAgICAgICAgICAgcmV0dXJuIHRyYW5zZmVySGFuZGxlcnMuZ2V0KHZhbHVlLm5hbWUpLmRlc2VyaWFsaXplKHZhbHVlLnZhbHVlKTtcclxuICAgICAgICBjYXNlIFwiUkFXXCIgLyogUkFXICovOlxyXG4gICAgICAgICAgICByZXR1cm4gdmFsdWUudmFsdWU7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gcmVxdWVzdFJlc3BvbnNlTWVzc2FnZShlcCwgbXNnLCB0cmFuc2ZlcnMpIHtcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGlkID0gZ2VuZXJhdGVVVUlEKCk7XHJcbiAgICAgICAgZXAuYWRkRXZlbnRMaXN0ZW5lcihcIm1lc3NhZ2VcIiwgZnVuY3Rpb24gbChldikge1xyXG4gICAgICAgICAgICBpZiAoIWV2LmRhdGEgfHwgIWV2LmRhdGEuaWQgfHwgZXYuZGF0YS5pZCAhPT0gaWQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlcC5yZW1vdmVFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLCBsKTtcclxuICAgICAgICAgICAgcmVzb2x2ZShldi5kYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBpZiAoZXAuc3RhcnQpIHtcclxuICAgICAgICAgICAgZXAuc3RhcnQoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZXAucG9zdE1lc3NhZ2UoT2JqZWN0LmFzc2lnbih7IGlkIH0sIG1zZyksIHRyYW5zZmVycyk7XHJcbiAgICB9KTtcclxufVxyXG5mdW5jdGlvbiBnZW5lcmF0ZVVVSUQoKSB7XHJcbiAgICByZXR1cm4gbmV3IEFycmF5KDQpXHJcbiAgICAgICAgLmZpbGwoMClcclxuICAgICAgICAubWFwKCgpID0+IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIE51bWJlci5NQVhfU0FGRV9JTlRFR0VSKS50b1N0cmluZygxNikpXHJcbiAgICAgICAgLmpvaW4oXCItXCIpO1xyXG59XG5cbmV4cG9ydCB7IGNyZWF0ZUVuZHBvaW50LCBleHBvc2UsIHByb3h5LCBwcm94eU1hcmtlciwgcmVsZWFzZVByb3h5LCB0cmFuc2ZlciwgdHJhbnNmZXJIYW5kbGVycywgd2luZG93RW5kcG9pbnQsIHdyYXAgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWNvbWxpbmsubWpzLm1hcFxuIl0sIm5hbWVzIjpbIlByb2dyYW1taW5nTGFuZ3VhZ2UiLCJQeXRob24iLCJKYXZhU2NyaXB0IiwiTWFwIiwiTG9nVHlwZSIsInBhcHlyb3NMb2ciLCJsb2dUeXBlIiwiZG9Mb2ciLCJEZWJ1ZyIsIkVycm9yIiwiY29uc29sZSIsImVycm9yIiwiYXJncyIsImxvZyIsInRoaXMiLCJvbkV2ZW50IiwicnVuSWQiLCJsYXVuY2giLCJpbnB1dFRleHRBcnJheSIsImlucHV0TWV0YURhdGEiLCJpbnB1dENhbGxiYWNrIiwiVGV4dERlY29kZXIiLCJBdG9taWNzIiwid2FpdCIsInN0b3JlIiwic2l6ZSIsImV4Y2hhbmdlIiwiYnl0ZXMiLCJzbGljZSIsImRlY29kZSIsInJlcXVlc3QiLCJYTUxIdHRwUmVxdWVzdCIsIm9wZW4iLCJzZW5kIiwic3RhdHVzIiwicmVzcG9uc2VUZXh0IiwiZ2V0SW5wdXRDYWxsYmFjayIsImUiLCJ0eXBlIiwiUHJvbWlzZSIsInJlc29sdmUiLCJydW5Db2RlIiwiY29kZSIsIl9ydW5Db2RlSW50ZXJuYWwiLCJkYXRhIiwiSW1wb3J0YW50IiwiZXJyb3JTdHJpbmciLCJ0b1N0cmluZyIsIkpTT04iLCJzdHJpbmdpZnkiLCJwcm94eU1hcmtlciIsIlN5bWJvbCIsImNyZWF0ZUVuZHBvaW50IiwicmVsZWFzZVByb3h5IiwidGhyb3dNYXJrZXIiLCJpc09iamVjdCIsInZhbCIsInRyYW5zZmVySGFuZGxlcnMiLCJjYW5IYW5kbGUiLCJzZXJpYWxpemUiLCJvYmoiLCJwb3J0MSIsInBvcnQyIiwiTWVzc2FnZUNoYW5uZWwiLCJleHBvc2UiLCJkZXNlcmlhbGl6ZSIsInBvcnQiLCJzdGFydCIsImNyZWF0ZVByb3h5IiwidGFyZ2V0IiwidmFsdWUiLCJzZXJpYWxpemVkIiwiaXNFcnJvciIsIm1lc3NhZ2UiLCJuYW1lIiwic3RhY2siLCJPYmplY3QiLCJhc3NpZ24iLCJlcCIsInNlbGYiLCJhZGRFdmVudExpc3RlbmVyIiwiY2FsbGJhY2siLCJldiIsImlkIiwicGF0aCIsImFyZ3VtZW50TGlzdCIsIm1hcCIsImZyb21XaXJlVmFsdWUiLCJyZXR1cm5WYWx1ZSIsInBhcmVudCIsInJlZHVjZSIsInByb3AiLCJyYXdWYWx1ZSIsImFwcGx5IiwicHJveHkiLCJ0cmFuc2ZlcnMiLCJ0cmFuc2ZlckNhY2hlIiwic2V0IiwidHJhbnNmZXIiLCJ1bmRlZmluZWQiLCJjYXRjaCIsInRoZW4iLCJ3aXJlVmFsdWUiLCJ0cmFuc2ZlcmFibGVzIiwidG9XaXJlVmFsdWUiLCJwb3N0TWVzc2FnZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJjbG9zZUVuZFBvaW50IiwiZW5kcG9pbnQiLCJjb25zdHJ1Y3RvciIsImlzTWVzc2FnZVBvcnQiLCJjbG9zZSIsInRocm93SWZQcm94eVJlbGVhc2VkIiwiaXNSZWxlYXNlZCIsImlzUHJveHlSZWxlYXNlZCIsIlByb3h5IiwiZ2V0IiwiX3RhcmdldCIsInJlcXVlc3RSZXNwb25zZU1lc3NhZ2UiLCJwIiwibGVuZ3RoIiwiciIsImJpbmQiLCJfdGhpc0FyZyIsInJhd0FyZ3VtZW50TGlzdCIsImxhc3QiLCJwcm9jZXNzQXJndW1lbnRzIiwiY29uc3RydWN0IiwicHJvY2Vzc2VkIiwidiIsImFyciIsIkFycmF5IiwicHJvdG90eXBlIiwiY29uY2F0IiwiV2Vha01hcCIsImhhbmRsZXIiLCJzZXJpYWxpemVkVmFsdWUiLCJtc2ciLCJmaWxsIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwiTnVtYmVyIiwiTUFYX1NBRkVfSU5URUdFUiIsImpvaW4iLCJsIl0sInNvdXJjZVJvb3QiOiIifQ==