(()=>{"use strict";var e,n,t={572:(e,n,t)=>{var r,o=t(375),i=t(872),s="__init_papyros",a="__process_code",l='\nfrom pyodide import to_js, eval_code_async\nfrom js import console\nimport sys\nimport ast\nimport json\nimport html\nimport types\nimport os\nimport micropip\nawait micropip.install(\'friendly_traceback\')\nimport friendly_traceback\nfrom friendly_traceback.core import FriendlyTraceback\n\n__papyros = None\n\nclass __Papyros():\n    def __init__(self, cb):\n        self.cb = cb\n        self.line = ""\n        self.override_builtins()\n\n    def message(self, data):\n        return self.cb(to_js(data))\n\n    def override_builtins(self):\n        self.override_output()\n        self.override_input()\n\n    def override_output(self):\n        class __OutputWriter:\n            def __init__(self, type, on_write):\n                self.encoding = "utf-8"\n                self.type = type\n                self.on_write = on_write\n                \n            def write(self, s):\n                self.on_write(dict(type=self.type, data=s))\n\n            def flush(self):\n                pass # Given data is always immediately written\n        on_write = lambda d: self.message(d)\n        sys.stdout = __OutputWriter("output", on_write)\n        sys.stderr = __OutputWriter("error", on_write)\n\n    def readline(self, n=-1, prompt=""):\n        if not self.line:\n            self.line = self.message(dict(type="input", data=prompt)) + "\\n"\n        if n < 0 or n > len(self.line):\n            n = len(self.line)\n        to_return = self.line[0:n]\n        self.line = self.line[n:]\n        return to_return\n\n    def globals(self, filename):\n        mod = types.ModuleType("__main__")\n        mod.__file__ = filename\n        sys.modules["__main__"] = mod\n        return mod.__dict__\n\n    def override_input(self):\n        sys.stdin.readline = self.readline\n        import builtins\n        builtins.input = lambda prompt="": self.readline(prompt=prompt)[:-1] # Remove newline\n\ndef format_exception(filename, exc):\n    fr = FriendlyTraceback(type(exc), exc, exc.__traceback__)\n    fr.assign_generic()\n    fr.assign_cause()\n    tb = fr.info.get("shortened_traceback", "No traceback")\n    info = fr.info.get("generic", "No information available.")\n    why = fr.info.get("cause", "Unknown cause")\n    what = fr.info.get("message", "No message")\n    user_start = 0\n    tb_lines = tb.split("\\n")\n    while user_start < len(tb_lines) and filename not in tb_lines[user_start]:\n        user_start += 1\n    name = type(exc).__name__\n    user_end = user_start + 1\n    while user_end < len(tb_lines) and name not in tb_lines[user_end]:\n        user_end += 1\n    where = "\\n".join(tb_lines[user_start:user_end]) or "No location"\n    return json.dumps(\n        dict(\n            name=name,\n            traceback=tb,\n            info=info,\n            why=why,\n            where=where,\n            what=what\n        )\n    )\n\ndef '.concat(s,"(cb):\n    global __papyros\n    __papyros = __Papyros(cb)\n\nasync def ").concat(a,'(code, run, filename="my_code.py"):\n    global __papyros\n    with open(filename, "w") as f:\n        f.write(code)\n    friendly_traceback.source_cache.cache.add(filename, code)\n    try:\n        if run:\n            await eval_code_async(code, __papyros.globals(filename),\n                filename=filename, return_mode="none")\n        else: # Only compile code (TODO separate Backend endpoint)\n            compile(code, filename, mode="exec", flags=ast.PyCF_ALLOW_TOP_LEVEL_AWAIT)\n        return True\n    except Exception as e:\n        __papyros.message(dict(type="error", data=format_exception(filename, e)))\n        return False\n\n'),c=(r=function(e,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])},r(e,n)},function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function t(){this.constructor=e}r(e,n),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)}),p=function(e,n,t,r){return new(t||(t=Promise))((function(o,i){function s(e){try{l(r.next(e))}catch(e){i(e)}}function a(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(s,a)}l((r=r.apply(e,n||[])).next())}))},u=function(e,n){var t,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;s;)try{if(t=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=n.call(e,s)}catch(e){i=[6,e],r=0}finally{t=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};importScripts("https://cdn.jsdelivr.net/pyodide/v0.18.1/full/pyodide.js");var f=function(e){function n(){var n=e.call(this)||this;return n.pyodide={},n.initialized=!1,n}return c(n,e),n.prototype.launch=function(n,t,r){return p(this,void 0,void 0,(function(){var o,i,a=this;return u(this,(function(c){switch(c.label){case 0:return[4,e.prototype.launch.call(this,n,t,r)];case 1:return c.sent(),o=this,[4,loadPyodide({indexURL:"https://cdn.jsdelivr.net/pyodide/v0.18.1/full/",fullStdLib:!1})];case 2:return o.pyodide=c.sent(),[4,this.runCode(l,0)];case 3:return c.sent(),i=function(e){var n="toJs"in e?e.toJs():Object.fromEntries(e);return a.onEvent(n)},this.pyodide.globals.get(s)(i),this.initialized=!0,[2]}}))}))},n.prototype._runCodeInternal=function(e){return p(this,void 0,void 0,(function(){return u(this,(function(n){switch(n.label){case 0:return this.initialized?[4,this.pyodide.globals.get(a)(e,!1)]:[3,5];case 1:return n.sent()?[4,this.pyodide.loadPackagesFromImports(e)]:[3,4];case 2:return n.sent(),[4,this.pyodide.globals.get(a)(e,!0)];case 3:n.sent(),n.label=4;case 4:return[3,7];case 5:return[4,this.pyodide.loadPackagesFromImports(e)];case 6:return n.sent(),[2,this.pyodide.runPythonAsync(e)];case 7:return[2]}}))}))},n}(i.z);(0,o.Jj)(new f)}},r={};function o(e){var n=r[e];if(void 0!==n)return n.exports;var i=r[e]={exports:{}};return t[e](i,i.exports,o),i.exports}o.m=t,o.x=()=>{var e=o.O(void 0,[114],(()=>o(572)));return o.O(e)},e=[],o.O=(n,t,r,i)=>{if(!t){var s=1/0;for(p=0;p<e.length;p++){for(var[t,r,i]=e[p],a=!0,l=0;l<t.length;l++)(!1&i||s>=i)&&Object.keys(o.O).every((e=>o.O[e](t[l])))?t.splice(l--,1):(a=!1,i<s&&(s=i));if(a){e.splice(p--,1);var c=r();void 0!==c&&(n=c)}}return n}i=i||0;for(var p=e.length;p>0&&e[p-1][2]>i;p--)e[p]=e[p-1];e[p]=[t,r,i]},o.d=(e,n)=>{for(var t in n)o.o(n,t)&&!o.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},o.f={},o.e=e=>Promise.all(Object.keys(o.f).reduce(((n,t)=>(o.f[t](e,n),n)),[])),o.u=e=>e+".bundle.js",o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),(()=>{var e;o.g.importScripts&&(e=o.g.location+"");var n=o.g.document;if(!e&&n&&(n.currentScript&&(e=n.currentScript.src),!e)){var t=n.getElementsByTagName("script");t.length&&(e=t[t.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),o.p=e})(),(()=>{var e={572:1};o.f.i=(n,t)=>{e[n]||importScripts(o.p+o.u(n))};var n=self.webpackChunkpapyros=self.webpackChunkpapyros||[],t=n.push.bind(n);n.push=n=>{var[r,i,s]=n;for(var a in i)o.o(i,a)&&(o.m[a]=i[a]);for(s&&s(o);r.length;)e[r.pop()]=1;t(n)}})(),n=o.x,o.x=()=>o.e(114).then(n),o.x()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UW5DLFNBQVE4QixFQUFZSyxFQUFRQSxFQUFRbkMsT0FBUyxHQUFHa0MsS0FLN0QsSUFBS0osRUFBVyxNQUFNLElBQUlPLE1BQU0seURBQ2hDUCxFQUFZQSxFQUFVUSxRQUFRLE9BQVEsSUFBSUEsUUFBUSxRQUFTLElBQUlBLFFBQVEsWUFBYSxLQUNwRnhELEVBQW9CeUQsRUFBSVQsRyxTQ1h4QixJQUFJVSxFQUFrQixDQUNyQixJQUFLLEdBZ0JOMUQsRUFBb0IrQixFQUFFZCxFQUFJLENBQUNnQixFQUFTSSxLQUUvQnFCLEVBQWdCekIsSUFFbEI1RCxjQUFjMkIsRUFBb0J5RCxFQUFJekQsRUFBb0JzQyxFQUFFTCxLQUsvRCxJQUFJMEIsRUFBcUJDLEtBQTBCLG9CQUFJQSxLQUEwQixxQkFBSyxHQUNsRkMsRUFBNkJGLEVBQW1CRyxLQUFLQyxLQUFLSixHQUM5REEsRUFBbUJHLEtBdkJDNUUsSUFDbkIsSUFBSzBCLEVBQVVvRCxFQUFhQyxHQUFXL0UsRUFDdkMsSUFBSSxJQUFJZSxLQUFZK0QsRUFDaEJoRSxFQUFvQjRCLEVBQUVvQyxFQUFhL0QsS0FDckNELEVBQW9CTyxFQUFFTixHQUFZK0QsRUFBWS9ELElBSWhELElBREdnRSxHQUFTQSxFQUFRakUsR0FDZFksRUFBU00sUUFDZHdDLEVBQWdCOUMsRUFBU3NELE9BQVMsRUFDbkNMLEVBQTJCM0UsSyxHVm5CeEJqQixFQUFPK0IsRUFBb0JRLEVBQy9CUixFQUFvQlEsRUFBSSxJQUNoQlIsRUFBb0JnQyxFQUFFLEtBQUttQyxLQUFLbEcsR1dEZCtCLEVBQW9CUSxLIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGFweXJvcy93ZWJwYWNrL3J1bnRpbWUvY2h1bmsgbG9hZGVkIiwid2VicGFjazovL3BhcHlyb3Mvd2VicGFjay9ydW50aW1lL3N0YXJ0dXAgY2h1bmsgZGVwZW5kZW5jaWVzIiwid2VicGFjazovL3BhcHlyb3MvLi9zcmMvd29ya2Vycy9weXRob24vaW5pdC5weS50cyIsIndlYnBhY2s6Ly9wYXB5cm9zLy4vc3JjL3dvcmtlcnMvcHl0aG9uL1B5dGhvbldvcmtlci53b3JrZXIudHMiLCJ3ZWJwYWNrOi8vcGFweXJvcy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9wYXB5cm9zL3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly9wYXB5cm9zL3dlYnBhY2svcnVudGltZS9lbnN1cmUgY2h1bmsiLCJ3ZWJwYWNrOi8vcGFweXJvcy93ZWJwYWNrL3J1bnRpbWUvZ2V0IGphdmFzY3JpcHQgY2h1bmsgZmlsZW5hbWUiLCJ3ZWJwYWNrOi8vcGFweXJvcy93ZWJwYWNrL3J1bnRpbWUvZ2xvYmFsIiwid2VicGFjazovL3BhcHlyb3Mvd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly9wYXB5cm9zL3dlYnBhY2svcnVudGltZS9wdWJsaWNQYXRoIiwid2VicGFjazovL3BhcHlyb3Mvd2VicGFjay9ydW50aW1lL2ltcG9ydFNjcmlwdHMgY2h1bmsgbG9hZGluZyIsIndlYnBhY2s6Ly9wYXB5cm9zL3dlYnBhY2svc3RhcnR1cCJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgZGVmZXJyZWQgPSBbXTtcbl9fd2VicGFja19yZXF1aXJlX18uTyA9IChyZXN1bHQsIGNodW5rSWRzLCBmbiwgcHJpb3JpdHkpID0+IHtcblx0aWYoY2h1bmtJZHMpIHtcblx0XHRwcmlvcml0eSA9IHByaW9yaXR5IHx8IDA7XG5cdFx0Zm9yKHZhciBpID0gZGVmZXJyZWQubGVuZ3RoOyBpID4gMCAmJiBkZWZlcnJlZFtpIC0gMV1bMl0gPiBwcmlvcml0eTsgaS0tKSBkZWZlcnJlZFtpXSA9IGRlZmVycmVkW2kgLSAxXTtcblx0XHRkZWZlcnJlZFtpXSA9IFtjaHVua0lkcywgZm4sIHByaW9yaXR5XTtcblx0XHRyZXR1cm47XG5cdH1cblx0dmFyIG5vdEZ1bGZpbGxlZCA9IEluZmluaXR5O1xuXHRmb3IgKHZhciBpID0gMDsgaSA8IGRlZmVycmVkLmxlbmd0aDsgaSsrKSB7XG5cdFx0dmFyIFtjaHVua0lkcywgZm4sIHByaW9yaXR5XSA9IGRlZmVycmVkW2ldO1xuXHRcdHZhciBmdWxmaWxsZWQgPSB0cnVlO1xuXHRcdGZvciAodmFyIGogPSAwOyBqIDwgY2h1bmtJZHMubGVuZ3RoOyBqKyspIHtcblx0XHRcdGlmICgocHJpb3JpdHkgJiAxID09PSAwIHx8IG5vdEZ1bGZpbGxlZCA+PSBwcmlvcml0eSkgJiYgT2JqZWN0LmtleXMoX193ZWJwYWNrX3JlcXVpcmVfXy5PKS5ldmVyeSgoa2V5KSA9PiAoX193ZWJwYWNrX3JlcXVpcmVfXy5PW2tleV0oY2h1bmtJZHNbal0pKSkpIHtcblx0XHRcdFx0Y2h1bmtJZHMuc3BsaWNlKGotLSwgMSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRmdWxmaWxsZWQgPSBmYWxzZTtcblx0XHRcdFx0aWYocHJpb3JpdHkgPCBub3RGdWxmaWxsZWQpIG5vdEZ1bGZpbGxlZCA9IHByaW9yaXR5O1xuXHRcdFx0fVxuXHRcdH1cblx0XHRpZihmdWxmaWxsZWQpIHtcblx0XHRcdGRlZmVycmVkLnNwbGljZShpLS0sIDEpXG5cdFx0XHR2YXIgciA9IGZuKCk7XG5cdFx0XHRpZiAociAhPT0gdW5kZWZpbmVkKSByZXN1bHQgPSByO1xuXHRcdH1cblx0fVxuXHRyZXR1cm4gcmVzdWx0O1xufTsiLCJ2YXIgbmV4dCA9IF9fd2VicGFja19yZXF1aXJlX18ueDtcbl9fd2VicGFja19yZXF1aXJlX18ueCA9ICgpID0+IHtcblx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18uZSgxMTQpLnRoZW4obmV4dCk7XG59OyIsImV4cG9ydCBjb25zdCBJTklUSUFMSVpFX1BZVEhPTl9CQUNLRU5EID0gXCJfX2luaXRfcGFweXJvc1wiO1xuZXhwb3J0IGNvbnN0IFBST0NFU1NfUFlUSE9OX0NPREUgPSBcIl9fcHJvY2Vzc19jb2RlXCI7XG5leHBvcnQgY29uc3QgSU5JVElBTElaQVRJT05fQ09ERSA9XG4gICAgYFxuZnJvbSBweW9kaWRlIGltcG9ydCB0b19qcywgZXZhbF9jb2RlX2FzeW5jXG5mcm9tIGpzIGltcG9ydCBjb25zb2xlXG5pbXBvcnQgc3lzXG5pbXBvcnQgYXN0XG5pbXBvcnQganNvblxuaW1wb3J0IGh0bWxcbmltcG9ydCB0eXBlc1xuaW1wb3J0IG9zXG5pbXBvcnQgbWljcm9waXBcbmF3YWl0IG1pY3JvcGlwLmluc3RhbGwoJ2ZyaWVuZGx5X3RyYWNlYmFjaycpXG5pbXBvcnQgZnJpZW5kbHlfdHJhY2ViYWNrXG5mcm9tIGZyaWVuZGx5X3RyYWNlYmFjay5jb3JlIGltcG9ydCBGcmllbmRseVRyYWNlYmFja1xuXG5fX3BhcHlyb3MgPSBOb25lXG5cbmNsYXNzIF9fUGFweXJvcygpOlxuICAgIGRlZiBfX2luaXRfXyhzZWxmLCBjYik6XG4gICAgICAgIHNlbGYuY2IgPSBjYlxuICAgICAgICBzZWxmLmxpbmUgPSBcIlwiXG4gICAgICAgIHNlbGYub3ZlcnJpZGVfYnVpbHRpbnMoKVxuXG4gICAgZGVmIG1lc3NhZ2Uoc2VsZiwgZGF0YSk6XG4gICAgICAgIHJldHVybiBzZWxmLmNiKHRvX2pzKGRhdGEpKVxuXG4gICAgZGVmIG92ZXJyaWRlX2J1aWx0aW5zKHNlbGYpOlxuICAgICAgICBzZWxmLm92ZXJyaWRlX291dHB1dCgpXG4gICAgICAgIHNlbGYub3ZlcnJpZGVfaW5wdXQoKVxuXG4gICAgZGVmIG92ZXJyaWRlX291dHB1dChzZWxmKTpcbiAgICAgICAgY2xhc3MgX19PdXRwdXRXcml0ZXI6XG4gICAgICAgICAgICBkZWYgX19pbml0X18oc2VsZiwgdHlwZSwgb25fd3JpdGUpOlxuICAgICAgICAgICAgICAgIHNlbGYuZW5jb2RpbmcgPSBcInV0Zi04XCJcbiAgICAgICAgICAgICAgICBzZWxmLnR5cGUgPSB0eXBlXG4gICAgICAgICAgICAgICAgc2VsZi5vbl93cml0ZSA9IG9uX3dyaXRlXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICBkZWYgd3JpdGUoc2VsZiwgcyk6XG4gICAgICAgICAgICAgICAgc2VsZi5vbl93cml0ZShkaWN0KHR5cGU9c2VsZi50eXBlLCBkYXRhPXMpKVxuXG4gICAgICAgICAgICBkZWYgZmx1c2goc2VsZik6XG4gICAgICAgICAgICAgICAgcGFzcyAjIEdpdmVuIGRhdGEgaXMgYWx3YXlzIGltbWVkaWF0ZWx5IHdyaXR0ZW5cbiAgICAgICAgb25fd3JpdGUgPSBsYW1iZGEgZDogc2VsZi5tZXNzYWdlKGQpXG4gICAgICAgIHN5cy5zdGRvdXQgPSBfX091dHB1dFdyaXRlcihcIm91dHB1dFwiLCBvbl93cml0ZSlcbiAgICAgICAgc3lzLnN0ZGVyciA9IF9fT3V0cHV0V3JpdGVyKFwiZXJyb3JcIiwgb25fd3JpdGUpXG5cbiAgICBkZWYgcmVhZGxpbmUoc2VsZiwgbj0tMSwgcHJvbXB0PVwiXCIpOlxuICAgICAgICBpZiBub3Qgc2VsZi5saW5lOlxuICAgICAgICAgICAgc2VsZi5saW5lID0gc2VsZi5tZXNzYWdlKGRpY3QodHlwZT1cImlucHV0XCIsIGRhdGE9cHJvbXB0KSkgKyBcIlxcXFxuXCJcbiAgICAgICAgaWYgbiA8IDAgb3IgbiA+IGxlbihzZWxmLmxpbmUpOlxuICAgICAgICAgICAgbiA9IGxlbihzZWxmLmxpbmUpXG4gICAgICAgIHRvX3JldHVybiA9IHNlbGYubGluZVswOm5dXG4gICAgICAgIHNlbGYubGluZSA9IHNlbGYubGluZVtuOl1cbiAgICAgICAgcmV0dXJuIHRvX3JldHVyblxuXG4gICAgZGVmIGdsb2JhbHMoc2VsZiwgZmlsZW5hbWUpOlxuICAgICAgICBtb2QgPSB0eXBlcy5Nb2R1bGVUeXBlKFwiX19tYWluX19cIilcbiAgICAgICAgbW9kLl9fZmlsZV9fID0gZmlsZW5hbWVcbiAgICAgICAgc3lzLm1vZHVsZXNbXCJfX21haW5fX1wiXSA9IG1vZFxuICAgICAgICByZXR1cm4gbW9kLl9fZGljdF9fXG5cbiAgICBkZWYgb3ZlcnJpZGVfaW5wdXQoc2VsZik6XG4gICAgICAgIHN5cy5zdGRpbi5yZWFkbGluZSA9IHNlbGYucmVhZGxpbmVcbiAgICAgICAgaW1wb3J0IGJ1aWx0aW5zXG4gICAgICAgIGJ1aWx0aW5zLmlucHV0ID0gbGFtYmRhIHByb21wdD1cIlwiOiBzZWxmLnJlYWRsaW5lKHByb21wdD1wcm9tcHQpWzotMV0gIyBSZW1vdmUgbmV3bGluZVxuXG5kZWYgZm9ybWF0X2V4Y2VwdGlvbihmaWxlbmFtZSwgZXhjKTpcbiAgICBmciA9IEZyaWVuZGx5VHJhY2ViYWNrKHR5cGUoZXhjKSwgZXhjLCBleGMuX190cmFjZWJhY2tfXylcbiAgICBmci5hc3NpZ25fZ2VuZXJpYygpXG4gICAgZnIuYXNzaWduX2NhdXNlKClcbiAgICB0YiA9IGZyLmluZm8uZ2V0KFwic2hvcnRlbmVkX3RyYWNlYmFja1wiLCBcIk5vIHRyYWNlYmFja1wiKVxuICAgIGluZm8gPSBmci5pbmZvLmdldChcImdlbmVyaWNcIiwgXCJObyBpbmZvcm1hdGlvbiBhdmFpbGFibGUuXCIpXG4gICAgd2h5ID0gZnIuaW5mby5nZXQoXCJjYXVzZVwiLCBcIlVua25vd24gY2F1c2VcIilcbiAgICB3aGF0ID0gZnIuaW5mby5nZXQoXCJtZXNzYWdlXCIsIFwiTm8gbWVzc2FnZVwiKVxuICAgIHVzZXJfc3RhcnQgPSAwXG4gICAgdGJfbGluZXMgPSB0Yi5zcGxpdChcIlxcXFxuXCIpXG4gICAgd2hpbGUgdXNlcl9zdGFydCA8IGxlbih0Yl9saW5lcykgYW5kIGZpbGVuYW1lIG5vdCBpbiB0Yl9saW5lc1t1c2VyX3N0YXJ0XTpcbiAgICAgICAgdXNlcl9zdGFydCArPSAxXG4gICAgbmFtZSA9IHR5cGUoZXhjKS5fX25hbWVfX1xuICAgIHVzZXJfZW5kID0gdXNlcl9zdGFydCArIDFcbiAgICB3aGlsZSB1c2VyX2VuZCA8IGxlbih0Yl9saW5lcykgYW5kIG5hbWUgbm90IGluIHRiX2xpbmVzW3VzZXJfZW5kXTpcbiAgICAgICAgdXNlcl9lbmQgKz0gMVxuICAgIHdoZXJlID0gXCJcXFxcblwiLmpvaW4odGJfbGluZXNbdXNlcl9zdGFydDp1c2VyX2VuZF0pIG9yIFwiTm8gbG9jYXRpb25cIlxuICAgIHJldHVybiBqc29uLmR1bXBzKFxuICAgICAgICBkaWN0KFxuICAgICAgICAgICAgbmFtZT1uYW1lLFxuICAgICAgICAgICAgdHJhY2ViYWNrPXRiLFxuICAgICAgICAgICAgaW5mbz1pbmZvLFxuICAgICAgICAgICAgd2h5PXdoeSxcbiAgICAgICAgICAgIHdoZXJlPXdoZXJlLFxuICAgICAgICAgICAgd2hhdD13aGF0XG4gICAgICAgIClcbiAgICApXG5cbmRlZiAke0lOSVRJQUxJWkVfUFlUSE9OX0JBQ0tFTkR9KGNiKTpcbiAgICBnbG9iYWwgX19wYXB5cm9zXG4gICAgX19wYXB5cm9zID0gX19QYXB5cm9zKGNiKVxuXG5hc3luYyBkZWYgJHtQUk9DRVNTX1BZVEhPTl9DT0RFfShjb2RlLCBydW4sIGZpbGVuYW1lPVwibXlfY29kZS5weVwiKTpcbiAgICBnbG9iYWwgX19wYXB5cm9zXG4gICAgd2l0aCBvcGVuKGZpbGVuYW1lLCBcIndcIikgYXMgZjpcbiAgICAgICAgZi53cml0ZShjb2RlKVxuICAgIGZyaWVuZGx5X3RyYWNlYmFjay5zb3VyY2VfY2FjaGUuY2FjaGUuYWRkKGZpbGVuYW1lLCBjb2RlKVxuICAgIHRyeTpcbiAgICAgICAgaWYgcnVuOlxuICAgICAgICAgICAgYXdhaXQgZXZhbF9jb2RlX2FzeW5jKGNvZGUsIF9fcGFweXJvcy5nbG9iYWxzKGZpbGVuYW1lKSxcbiAgICAgICAgICAgICAgICBmaWxlbmFtZT1maWxlbmFtZSwgcmV0dXJuX21vZGU9XCJub25lXCIpXG4gICAgICAgIGVsc2U6ICMgT25seSBjb21waWxlIGNvZGUgKFRPRE8gc2VwYXJhdGUgQmFja2VuZCBlbmRwb2ludClcbiAgICAgICAgICAgIGNvbXBpbGUoY29kZSwgZmlsZW5hbWUsIG1vZGU9XCJleGVjXCIsIGZsYWdzPWFzdC5QeUNGX0FMTE9XX1RPUF9MRVZFTF9BV0FJVClcbiAgICAgICAgcmV0dXJuIFRydWVcbiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6XG4gICAgICAgIF9fcGFweXJvcy5tZXNzYWdlKGRpY3QodHlwZT1cImVycm9yXCIsIGRhdGE9Zm9ybWF0X2V4Y2VwdGlvbihmaWxlbmFtZSwgZSkpKVxuICAgICAgICByZXR1cm4gRmFsc2VcblxuYDtcbiIsImltcG9ydCB7IGV4cG9zZSB9IGZyb20gXCJjb21saW5rXCI7XG5pbXBvcnQgeyBCYWNrZW5kIH0gZnJvbSBcIi4uLy4uL0JhY2tlbmRcIjtcbmltcG9ydCB7IFBhcHlyb3NFdmVudCB9IGZyb20gXCIuLi8uLi9QYXB5cm9zRXZlbnRcIjtcbmltcG9ydCB7IElOSVRJQUxJWkFUSU9OX0NPREUsIElOSVRJQUxJWkVfUFlUSE9OX0JBQ0tFTkQsIFBST0NFU1NfUFlUSE9OX0NPREUgfSBmcm9tIFwiLi9pbml0LnB5XCI7XG5cbmludGVyZmFjZSBQeW9kaWRlIHtcbiAgICBydW5QeXRob246IChjb2RlOiBzdHJpbmcsIGdsb2JhbHM/OiBhbnkpID0+IGFueTtcbiAgICBydW5QeXRob25Bc3luYzogKGNvZGU6IHN0cmluZykgPT4gUHJvbWlzZTx2b2lkPjtcbiAgICBsb2FkUGFja2FnZXNGcm9tSW1wb3J0czogKGNvZGU6IHN0cmluZykgPT4gUHJvbWlzZTx2b2lkPjtcbiAgICBnbG9iYWxzOiBNYXA8c3RyaW5nLCBhbnk+O1xufVxuZGVjbGFyZSBmdW5jdGlvbiBpbXBvcnRTY3JpcHRzKC4uLnVybHM6IHN0cmluZ1tdKTogdm9pZDtcbmRlY2xhcmUgZnVuY3Rpb24gbG9hZFB5b2RpZGUoYXJnczogeyBpbmRleFVSTDogc3RyaW5nOyBmdWxsU3RkTGliOiBib29sZWFuIH0pOiBQcm9taXNlPFB5b2RpZGU+O1xuXG5pbXBvcnRTY3JpcHRzKFwiaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L3B5b2RpZGUvdjAuMTguMS9mdWxsL3B5b2RpZGUuanNcIik7XG5cblxuY2xhc3MgUHl0aG9uV29ya2VyIGV4dGVuZHMgQmFja2VuZCB7XG4gICAgcHlvZGlkZTogUHlvZGlkZTtcbiAgICBpbml0aWFsaXplZDogYm9vbGVhbjtcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnB5b2RpZGUgPSB7fSBhcyBQeW9kaWRlO1xuICAgICAgICB0aGlzLmluaXRpYWxpemVkID0gZmFsc2U7XG4gICAgfVxuXG4gICAgb3ZlcnJpZGUgYXN5bmMgbGF1bmNoKG9uRXZlbnQ6IChlOiBQYXB5cm9zRXZlbnQpID0+IHZvaWQsXG4gICAgICAgIGlucHV0VGV4dEFycmF5PzogVWludDhBcnJheSwgaW5wdXRNZXRhRGF0YT86IEludDMyQXJyYXkpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgYXdhaXQgc3VwZXIubGF1bmNoKG9uRXZlbnQsIGlucHV0VGV4dEFycmF5LCBpbnB1dE1ldGFEYXRhKTtcbiAgICAgICAgdGhpcy5weW9kaWRlID0gYXdhaXQgbG9hZFB5b2RpZGUoe1xuICAgICAgICAgICAgaW5kZXhVUkw6IFwiaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L3B5b2RpZGUvdjAuMTguMS9mdWxsL1wiLFxuICAgICAgICAgICAgZnVsbFN0ZExpYjogZmFsc2VcbiAgICAgICAgfSk7XG4gICAgICAgIGF3YWl0IHRoaXMucnVuQ29kZShJTklUSUFMSVpBVElPTl9DT0RFLCAwKTtcbiAgICAgICAgLy8gUHl0aG9uIGNhbGxzIG91ciBmdW5jdGlvbiB3aXRoIGEgZGljdCwgd2hpY2ggbXVzdCBiZSBjb252ZXJ0ZWQgdG8gYSBQYXB5cm9zRXZlbnRcbiAgICAgICAgY29uc3QgZXZlbnRDYWxsYmFjayA9IChkYXRhOiBhbnkpOiB2b2lkID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGpzRXZlbnQ6IFBhcHlyb3NFdmVudCA9IFwidG9Kc1wiIGluIGRhdGEgPyBkYXRhLnRvSnMoKSA6IE9iamVjdC5mcm9tRW50cmllcyhkYXRhKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm9uRXZlbnQoanNFdmVudCk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMucHlvZGlkZS5nbG9iYWxzLmdldChJTklUSUFMSVpFX1BZVEhPTl9CQUNLRU5EKShldmVudENhbGxiYWNrKTtcbiAgICAgICAgdGhpcy5pbml0aWFsaXplZCA9IHRydWU7XG4gICAgfVxuXG4gICAgb3ZlcnJpZGUgYXN5bmMgX3J1bkNvZGVJbnRlcm5hbChjb2RlOiBzdHJpbmcpOiBQcm9taXNlPGFueT4ge1xuICAgICAgICBpZiAodGhpcy5pbml0aWFsaXplZCkge1xuICAgICAgICAgICAgaWYgKGF3YWl0IHRoaXMucHlvZGlkZS5nbG9iYWxzLmdldChQUk9DRVNTX1BZVEhPTl9DT0RFKShjb2RlLCBmYWxzZSkpIHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnB5b2RpZGUubG9hZFBhY2thZ2VzRnJvbUltcG9ydHMoY29kZSk7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5weW9kaWRlLmdsb2JhbHMuZ2V0KFBST0NFU1NfUFlUSE9OX0NPREUpKGNvZGUsIHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5weW9kaWRlLmxvYWRQYWNrYWdlc0Zyb21JbXBvcnRzKGNvZGUpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHlvZGlkZS5ydW5QeXRob25Bc3luYyhjb2RlKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZXhwb3NlKG5ldyBQeXRob25Xb3JrZXIoKSk7XG4iLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuLy8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbl9fd2VicGFja19yZXF1aXJlX18ubSA9IF9fd2VicGFja19tb2R1bGVzX187XG5cbi8vIHRoZSBzdGFydHVwIGZ1bmN0aW9uXG5fX3dlYnBhY2tfcmVxdWlyZV9fLnggPSAoKSA9PiB7XG5cdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuXHQvLyBUaGlzIGVudHJ5IG1vZHVsZSBkZXBlbmRzIG9uIG90aGVyIGxvYWRlZCBjaHVua3MgYW5kIGV4ZWN1dGlvbiBuZWVkIHRvIGJlIGRlbGF5ZWRcblx0dmFyIF9fd2VicGFja19leHBvcnRzX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fLk8odW5kZWZpbmVkLCBbMTE0XSwgKCkgPT4gKF9fd2VicGFja19yZXF1aXJlX18oNTcyKSkpXG5cdF9fd2VicGFja19leHBvcnRzX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fLk8oX193ZWJwYWNrX2V4cG9ydHNfXyk7XG5cdHJldHVybiBfX3dlYnBhY2tfZXhwb3J0c19fO1xufTtcblxuIiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5mID0ge307XG4vLyBUaGlzIGZpbGUgY29udGFpbnMgb25seSB0aGUgZW50cnkgY2h1bmsuXG4vLyBUaGUgY2h1bmsgbG9hZGluZyBmdW5jdGlvbiBmb3IgYWRkaXRpb25hbCBjaHVua3Ncbl9fd2VicGFja19yZXF1aXJlX18uZSA9IChjaHVua0lkKSA9PiB7XG5cdHJldHVybiBQcm9taXNlLmFsbChPYmplY3Qua2V5cyhfX3dlYnBhY2tfcmVxdWlyZV9fLmYpLnJlZHVjZSgocHJvbWlzZXMsIGtleSkgPT4ge1xuXHRcdF9fd2VicGFja19yZXF1aXJlX18uZltrZXldKGNodW5rSWQsIHByb21pc2VzKTtcblx0XHRyZXR1cm4gcHJvbWlzZXM7XG5cdH0sIFtdKSk7XG59OyIsIi8vIFRoaXMgZnVuY3Rpb24gYWxsb3cgdG8gcmVmZXJlbmNlIGFzeW5jIGNodW5rcyBhbmQgc2libGluZyBjaHVua3MgZm9yIHRoZSBlbnRyeXBvaW50XG5fX3dlYnBhY2tfcmVxdWlyZV9fLnUgPSAoY2h1bmtJZCkgPT4ge1xuXHQvLyByZXR1cm4gdXJsIGZvciBmaWxlbmFtZXMgYmFzZWQgb24gdGVtcGxhdGVcblx0cmV0dXJuIFwiXCIgKyBjaHVua0lkICsgXCIuYnVuZGxlLmpzXCI7XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18uZyA9IChmdW5jdGlvbigpIHtcblx0aWYgKHR5cGVvZiBnbG9iYWxUaGlzID09PSAnb2JqZWN0JykgcmV0dXJuIGdsb2JhbFRoaXM7XG5cdHRyeSB7XG5cdFx0cmV0dXJuIHRoaXMgfHwgbmV3IEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKCk7XG5cdH0gY2F0Y2ggKGUpIHtcblx0XHRpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcpIHJldHVybiB3aW5kb3c7XG5cdH1cbn0pKCk7IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsInZhciBzY3JpcHRVcmw7XG5pZiAoX193ZWJwYWNrX3JlcXVpcmVfXy5nLmltcG9ydFNjcmlwdHMpIHNjcmlwdFVybCA9IF9fd2VicGFja19yZXF1aXJlX18uZy5sb2NhdGlvbiArIFwiXCI7XG52YXIgZG9jdW1lbnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLmcuZG9jdW1lbnQ7XG5pZiAoIXNjcmlwdFVybCAmJiBkb2N1bWVudCkge1xuXHRpZiAoZG9jdW1lbnQuY3VycmVudFNjcmlwdClcblx0XHRzY3JpcHRVcmwgPSBkb2N1bWVudC5jdXJyZW50U2NyaXB0LnNyY1xuXHRpZiAoIXNjcmlwdFVybCkge1xuXHRcdHZhciBzY3JpcHRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJzY3JpcHRcIik7XG5cdFx0aWYoc2NyaXB0cy5sZW5ndGgpIHNjcmlwdFVybCA9IHNjcmlwdHNbc2NyaXB0cy5sZW5ndGggLSAxXS5zcmNcblx0fVxufVxuLy8gV2hlbiBzdXBwb3J0aW5nIGJyb3dzZXJzIHdoZXJlIGFuIGF1dG9tYXRpYyBwdWJsaWNQYXRoIGlzIG5vdCBzdXBwb3J0ZWQgeW91IG11c3Qgc3BlY2lmeSBhbiBvdXRwdXQucHVibGljUGF0aCBtYW51YWxseSB2aWEgY29uZmlndXJhdGlvblxuLy8gb3IgcGFzcyBhbiBlbXB0eSBzdHJpbmcgKFwiXCIpIGFuZCBzZXQgdGhlIF9fd2VicGFja19wdWJsaWNfcGF0aF9fIHZhcmlhYmxlIGZyb20geW91ciBjb2RlIHRvIHVzZSB5b3VyIG93biBsb2dpYy5cbmlmICghc2NyaXB0VXJsKSB0aHJvdyBuZXcgRXJyb3IoXCJBdXRvbWF0aWMgcHVibGljUGF0aCBpcyBub3Qgc3VwcG9ydGVkIGluIHRoaXMgYnJvd3NlclwiKTtcbnNjcmlwdFVybCA9IHNjcmlwdFVybC5yZXBsYWNlKC8jLiokLywgXCJcIikucmVwbGFjZSgvXFw/LiokLywgXCJcIikucmVwbGFjZSgvXFwvW15cXC9dKyQvLCBcIi9cIik7XG5fX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBzY3JpcHRVcmw7IiwiLy8gbm8gYmFzZVVSSVxuXG4vLyBvYmplY3QgdG8gc3RvcmUgbG9hZGVkIGNodW5rc1xuLy8gXCIxXCIgbWVhbnMgXCJhbHJlYWR5IGxvYWRlZFwiXG52YXIgaW5zdGFsbGVkQ2h1bmtzID0ge1xuXHQ1NzI6IDFcbn07XG5cbi8vIGltcG9ydFNjcmlwdHMgY2h1bmsgbG9hZGluZ1xudmFyIGluc3RhbGxDaHVuayA9IChkYXRhKSA9PiB7XG5cdHZhciBbY2h1bmtJZHMsIG1vcmVNb2R1bGVzLCBydW50aW1lXSA9IGRhdGE7XG5cdGZvcih2YXIgbW9kdWxlSWQgaW4gbW9yZU1vZHVsZXMpIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8obW9yZU1vZHVsZXMsIG1vZHVsZUlkKSkge1xuXHRcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tW21vZHVsZUlkXSA9IG1vcmVNb2R1bGVzW21vZHVsZUlkXTtcblx0XHR9XG5cdH1cblx0aWYocnVudGltZSkgcnVudGltZShfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblx0d2hpbGUoY2h1bmtJZHMubGVuZ3RoKVxuXHRcdGluc3RhbGxlZENodW5rc1tjaHVua0lkcy5wb3AoKV0gPSAxO1xuXHRwYXJlbnRDaHVua0xvYWRpbmdGdW5jdGlvbihkYXRhKTtcbn07XG5fX3dlYnBhY2tfcmVxdWlyZV9fLmYuaSA9IChjaHVua0lkLCBwcm9taXNlcykgPT4ge1xuXHQvLyBcIjFcIiBpcyB0aGUgc2lnbmFsIGZvciBcImFscmVhZHkgbG9hZGVkXCJcblx0aWYoIWluc3RhbGxlZENodW5rc1tjaHVua0lkXSkge1xuXHRcdGlmKHRydWUpIHsgLy8gYWxsIGNodW5rcyBoYXZlIEpTXG5cdFx0XHRpbXBvcnRTY3JpcHRzKF9fd2VicGFja19yZXF1aXJlX18ucCArIF9fd2VicGFja19yZXF1aXJlX18udShjaHVua0lkKSk7XG5cdFx0fVxuXHR9XG59O1xuXG52YXIgY2h1bmtMb2FkaW5nR2xvYmFsID0gc2VsZltcIndlYnBhY2tDaHVua3BhcHlyb3NcIl0gPSBzZWxmW1wid2VicGFja0NodW5rcGFweXJvc1wiXSB8fCBbXTtcbnZhciBwYXJlbnRDaHVua0xvYWRpbmdGdW5jdGlvbiA9IGNodW5rTG9hZGluZ0dsb2JhbC5wdXNoLmJpbmQoY2h1bmtMb2FkaW5nR2xvYmFsKTtcbmNodW5rTG9hZGluZ0dsb2JhbC5wdXNoID0gaW5zdGFsbENodW5rO1xuXG4vLyBubyBITVJcblxuLy8gbm8gSE1SIG1hbmlmZXN0IiwiLy8gcnVuIHN0YXJ0dXBcbnZhciBfX3dlYnBhY2tfZXhwb3J0c19fID0gX193ZWJwYWNrX3JlcXVpcmVfXy54KCk7XG4iXSwibmFtZXMiOlsiZGVmZXJyZWQiLCJuZXh0IiwiSU5JVElBTElaRV9QWVRIT05fQkFDS0VORCIsIlBST0NFU1NfUFlUSE9OX0NPREUiLCJJTklUSUFMSVpBVElPTl9DT0RFIiwiaW1wb3J0U2NyaXB0cyIsInB5b2RpZGUiLCJpbml0aWFsaXplZCIsImxhdW5jaCIsIm9uRXZlbnQiLCJpbnB1dFRleHRBcnJheSIsImlucHV0TWV0YURhdGEiLCJ0aGlzIiwibG9hZFB5b2RpZGUiLCJpbmRleFVSTCIsImZ1bGxTdGRMaWIiLCJydW5Db2RlIiwiZXZlbnRDYWxsYmFjayIsImRhdGEiLCJqc0V2ZW50IiwidG9KcyIsIk9iamVjdCIsImZyb21FbnRyaWVzIiwiZ2xvYmFscyIsImdldCIsIl9ydW5Db2RlSW50ZXJuYWwiLCJjb2RlIiwibG9hZFBhY2thZ2VzRnJvbUltcG9ydHMiLCJydW5QeXRob25Bc3luYyIsIkJhY2tlbmQiLCJQeXRob25Xb3JrZXIiLCJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJ1bmRlZmluZWQiLCJleHBvcnRzIiwibW9kdWxlIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsIm0iLCJ4IiwiX193ZWJwYWNrX2V4cG9ydHNfXyIsIk8iLCJyZXN1bHQiLCJjaHVua0lkcyIsImZuIiwicHJpb3JpdHkiLCJub3RGdWxmaWxsZWQiLCJJbmZpbml0eSIsImkiLCJsZW5ndGgiLCJmdWxmaWxsZWQiLCJqIiwia2V5cyIsImV2ZXJ5Iiwia2V5Iiwic3BsaWNlIiwiciIsImQiLCJkZWZpbml0aW9uIiwibyIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImYiLCJlIiwiY2h1bmtJZCIsIlByb21pc2UiLCJhbGwiLCJyZWR1Y2UiLCJwcm9taXNlcyIsInUiLCJnIiwiZ2xvYmFsVGhpcyIsIkZ1bmN0aW9uIiwid2luZG93Iiwib2JqIiwicHJvcCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsInNjcmlwdFVybCIsImxvY2F0aW9uIiwiZG9jdW1lbnQiLCJjdXJyZW50U2NyaXB0Iiwic3JjIiwic2NyaXB0cyIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwiRXJyb3IiLCJyZXBsYWNlIiwicCIsImluc3RhbGxlZENodW5rcyIsImNodW5rTG9hZGluZ0dsb2JhbCIsInNlbGYiLCJwYXJlbnRDaHVua0xvYWRpbmdGdW5jdGlvbiIsInB1c2giLCJiaW5kIiwibW9yZU1vZHVsZXMiLCJydW50aW1lIiwicG9wIiwidGhlbiJdLCJzb3VyY2VSb290IjoiIn0=