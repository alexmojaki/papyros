(this.webpackJsonppapyros=this.webpackJsonppapyros||[]).push([[0],[,,,function(e,n,t){"use strict";(function(e,r){t.d(n,"a",(function(){return s})),t.d(n,"b",(function(){return d}));var a=t(0),o=t.n(a),i=t(1),u=t(2),c=new Map;function s(n){var t;switch(n=n.toLowerCase()){case"python":t=new Worker(e,void 0);break;case"javascript":t=new Worker(r,void 0);break;default:throw new Error("".concat(n," is not yet supported."))}var a=Object(u.c)(t);return c.set(a,t),a}function d(e){return p.apply(this,arguments)}function p(){return(p=Object(i.a)(o.a.mark((function e(n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!c.has(n)){e.next=7;break}c.get(n).terminate(),n[u.b](),c.delete(n),e.next=8;break;case 7:throw new Error("Unknown backend supplied for language ".concat(n.toString()));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}}).call(this,t(7),t(8))},,function(e,n,t){},,function(e,n,t){e.exports=t.p+"static/js/0.c847ba33.chunk.worker.js"},function(e,n,t){e.exports=t.p+"static/js/1.59658b87.chunk.worker.js"},function(e,n,t){"use strict";t.r(n);t(4),t(5);var r,a="/__papyros_input",o=t(0),i=t.n(o),u=t(1),c=t(2),s=t(3);!function(e){e[e.Debug=0]="Debug",e[e.Error=1]="Error",e[e.Important=2]="Important"}(r||(r={}));function d(e){var n=e!==r.Debug;if(n){for(var t=arguments.length,a=new Array(t>1?t-1:0),o=1;o<t;o++)a[o-1]=arguments[o];var i,u;if(e===r.Error)(i=console).error.apply(i,a);else(u=console).log.apply(u,a)}}function p(e,n){var t,o=document.getElementById("code-area"),p=0,f=document.getElementById("code-input-area"),l=document.getElementById("code-output-area"),g=document.getElementById("language-select"),b=document.getElementById("run-code-btn"),y=document.getElementById("terminate-btn"),h=!1,v=new TextEncoder;function w(a){return b.disabled=!0,a&&(g.value=a),(t=Object(s.a)(g.value)).launch(Object(c.a)((function(e){return function(e){d(r.Debug,"received event in onMessage",e),"output"===e.type?l.value+=e.data:"input"===e.type?function(e){I.apply(this,arguments)}(e):"error"===e.type&&m(e)}(e)})),e,n).then((function(){b.disabled=!1}))}function m(e){d(r.Debug,"Got error in Papyros: ",e),l.value+=e.data}function k(){return E.apply(this,arguments)}function E(){return(E=Object(u.a)(i.a.mark((function t(){var o,u,c;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(d(r.Debug,"Handling send Input in Papyros"),!((o=f.value.split("\n")).length>p&&o[p])){t.next=19;break}if(d(r.Debug,"Sending input to user: "+o[p]),u=o[p],n&&e){t.next=10;break}return t.next=8,fetch(a,{method:"POST",body:JSON.stringify({input:u})});case 8:t.next=14;break;case 10:c=v.encode(o[p]),e.set(c),Atomics.store(n,1,c.length),Atomics.store(n,0,1);case 14:return p+=1,h=!1,t.abrupt("return",!0);case 19:return d(r.Debug,"Had no input to send, still waiting!"),t.abrupt("return",!1);case 21:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function I(){return(I=Object(u.a)(i.a.mark((function e(n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d(r.Debug,"Received onInput event in Papyros: ",n),e.next=3,k();case 3:if(e.sent){e.next=6;break}h=!0,d(r.Debug,"User needs to enter input before code can continue");case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}w(new URLSearchParams(window.location.search).get("language")||"python"),f.onkeydown=function(e){d(r.Debug,"Key down in inputArea",e),h&&"enter"===e.key.toLowerCase()&&(d(r.Debug,"Pressed enter! Sending input to user"),k())},b.addEventListener("click",(function(){return b.disabled=!0,p=0,l.value="",y.hidden=!1,d(r.Debug,"Running code in Papyros, sending to backend"),t.runCode(o.value).catch(m).finally((function(){y.hidden=!0,b.disabled=!1}))})),y.addEventListener("click",(function(){return d(r.Debug,"Called terminate, stopping backend!"),y.hidden=!0,Object(s.b)(t).then((function(){return w()}))})),g.addEventListener("change",(function(){return Object(s.b)(t).finally((function(){return w()}))}))}var f="__papyros_reloading";function l(){var e=void 0,n=void 0;"undefined"!==typeof SharedArrayBuffer?(d(r.Important,"Using SharedArrayBuffers"),e=new Uint8Array(new SharedArrayBuffer(1024*Uint8Array.BYTES_PER_ELEMENT)),n=new Int32Array(new SharedArrayBuffer(2*Int32Array.BYTES_PER_ELEMENT))):d(r.Important,"Using serviceWorker for input"),p(e,n)}window.localStorage.getItem(f)?(window.localStorage.removeItem(f),l()):"undefined"===typeof SharedArrayBuffer?(d(r.Important,"SharedArrayBuffers are not available. "),"serviceWorker"in navigator?(d(r.Important,"Registering service worker."),window.localStorage.setItem(f,f),navigator.serviceWorker.register("./inputServiceWorker.js",{scope:""}).then((function(){return window.location.reload()}))):document.getElementById("papyros").innerHTML="Your browser is unsupported. Please use a modern version of Chrome, Safari, Firefox, ..."):l()}],[[9,1,2]]]);
//# sourceMappingURL=main.ca3a60ba.chunk.js.map