(this.webpackJsonppapyros=this.webpackJsonppapyros||[]).push([[0],[,,,function(e,n,t){"use strict";(function(e,r){t.d(n,"a",(function(){return s})),t.d(n,"b",(function(){return d}));var o=t(0),a=t.n(o),c=t(1),i=t(2),u=new Map;function s(n){var t;switch(n=n.toLowerCase()){case"python":t=new Worker(e,void 0);break;case"javascript":t=new Worker(r,void 0);break;default:throw new Error("".concat(n," is not yet supported."))}var o=Object(i.c)(t);return u.set(o,t),o}function d(e){return p.apply(this,arguments)}function p(){return(p=Object(c.a)(a.a.mark((function e(n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!u.has(n)){e.next=7;break}u.get(n).terminate(),n[i.b](),u.delete(n),e.next=8;break;case 7:throw new Error("Unknown backend supplied for language ".concat(n.toString()));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}}).call(this,t(7),t(8))},,function(e,n,t){},,function(e,n,t){e.exports=t.p+"static/js/0.8ed1cb57.chunk.worker.js"},function(e,n,t){e.exports=t.p+"static/js/1.4893d024.chunk.worker.js"},function(e,n,t){"use strict";t.r(n);t(4),t(5);var r=t(0),o=t.n(r),a=t(1),c=t(2),i=t(3);!function(){var e,n=document.getElementById("code-area"),t=0,r=document.getElementById("code-input-area"),u=document.getElementById("code-output-area"),s=document.getElementById("language-select"),d=document.getElementById("run-code-btn"),p=document.getElementById("terminate-btn"),l=!1,f=new TextEncoder,g=void 0,y=void 0,h="".concat(document.location.pathname,"input");function b(n){return d.disabled=!0,n&&(s.value=n),(e=Object(i.a)(s.value)).launch(Object(c.a)((function(e){return function(e){console.log("received event in onMessage",e),"output"===e.type?u.value+=e.data:"input"===e.type?function(e){m.apply(this,arguments)}(e):"error"===e.type&&v(e)}(e)})),g,y).then((function(){d.disabled=!1}))}function v(e){console.log("Got error in Papyros: ",e),u.value+=e.data}function w(){return k.apply(this,arguments)}function k(){return(k=Object(a.a)(o.a.mark((function e(){var n,a,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("Handling send Input in Papyros"),!((n=r.value.split("\n")).length>t&&n[t])){e.next=19;break}if(console.log("Sending input to user: "+n[t]),a=n[t],y&&g){e.next=10;break}return e.next=8,fetch(h,{method:"POST",body:JSON.stringify({input:a})});case 8:e.next=14;break;case 10:c=f.encode(n[t]),g.set(c),Atomics.store(y,1,c.length),Atomics.store(y,0,1);case 14:return t+=1,l=!1,e.abrupt("return",!0);case 19:return console.log("Had no input to send, still waiting!"),e.abrupt("return",!1);case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(){return(m=Object(a.a)(o.a.mark((function e(n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Received onInput event in Papyros: ",n),e.next=3,w();case 3:if(e.sent){e.next=6;break}l=!0,console.log("User needs to enter input before code can continue");case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}"undefined"!==typeof SharedArrayBuffer?(g=new Uint8Array(new SharedArrayBuffer(1024*Uint8Array.BYTES_PER_ELEMENT)),y=new Int32Array(new SharedArrayBuffer(2*Int32Array.BYTES_PER_ELEMENT))):"serviceWorker"in navigator?navigator.serviceWorker.register("./inputServiceWorker.js",{scope:""}):document.getElementById("papyros").innerHTML="Your browser is unsupported. Please use a modern version of Chrome, Safari, Firefox, ...",b(new URLSearchParams(window.location.search).get("language")||"python"),r.onkeydown=function(e){console.log("Key down in inputArea",e),l&&"enter"===e.key.toLowerCase()&&(console.log("Pressed enter! Sending input to user"),w())},d.addEventListener("click",(function(){return d.disabled=!0,t=0,u.value="",p.hidden=!1,console.log("Running code in Papyros, sending to backend"),e.runCode(n.value).catch(v).finally((function(){p.hidden=!0,d.disabled=!1}))})),p.addEventListener("click",(function(){return console.log("Called terminate, stopping backend!"),p.hidden=!0,Object(i.b)(e).then((function(){return b()}))})),s.addEventListener("change",(function(){return Object(i.b)(e).finally((function(){return b()}))}))}()}],[[9,1,2]]]);
//# sourceMappingURL=main.e501efb8.chunk.js.map